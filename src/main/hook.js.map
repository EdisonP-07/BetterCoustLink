{"version":3,"file":"hook.js","sourceRoot":"","sources":["hook.ts"],"names":[],"mappings":"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","sourcesContent":["import { app, ipcMain } from 'electron';\nimport GameReader from './GameReader';\nimport { keyboardWatcher } from 'node-keyboard-watcher';\nimport Store from 'electron-store';\nimport { ISettings } from '../common/ISettings';\nimport { IpcHandlerMessages, IpcMessages, IpcRendererMessages, IpcSyncMessages } from '../common/ipc-messages';\n\nconst store = new Store<ISettings>();\n\nconst currentPlayerConfigMap = store.get('playerConfigMap', {});\nconst playerConfigMapLength = Object.keys(currentPlayerConfigMap).length;\nconsole.log('CONFIG count: ', playerConfigMapLength);\nif (playerConfigMapLength > 50) {\n\tstore.set('playerConfigMap', {});\n}\n\nlet readingGame = false;\nexport let gameReader: GameReader;\n\nlet pushToTalkShortcut: K | undefined;\nlet deafenShortcut: K | undefined;\nlet muteShortcut: K | undefined;\nlet impostorRadioShortcut: K | undefined;\nfunction resetKeyHooks(): void {\n\tpushToTalkShortcut = store.get('pushToTalkShortcut', 'V') as K;\n\tdeafenShortcut = store.get('deafenShortcut', 'RControl') as K;\n\tmuteShortcut = store.get('muteShortcut', 'RAlt') as K;\n\timpostorRadioShortcut = store.get('impostorRadioShortcut', 'F') as K;\n\tkeyboardWatcher.clearKeyHooks();\n\taddKeyHandler(pushToTalkShortcut);\n\taddKeyHandler(deafenShortcut);\n\taddKeyHandler(muteShortcut);\n\taddKeyHandler(impostorRadioShortcut);\n}\n\nipcMain.on(IpcHandlerMessages.RESET_KEYHOOKS, () => {\n\tresetKeyHooks();\n});\n\nipcMain.on(IpcHandlerMessages.JOIN_LOBBY, (event, lobbycode, server) => {\n\tconst tryjoin = gameReader?.joinGame(lobbycode, server);\n\tconsole.log('JOIN LOBBY:', lobbycode, tryjoin);\n\n\tif (!tryjoin) {\n\t\tevent.reply(IpcHandlerMessages.JOIN_LOBBY_ERROR, lobbycode, server);\n\t}\n});\n\nipcMain.on(IpcSyncMessages.GET_INITIAL_STATE, (event) => {\n\tif (!readingGame) {\n\t\tconsole.error('Recieved GET_INITIAL_STATE message before the START_HOOK message was received');\n\t\tevent.returnValue = null;\n\t\treturn;\n\t}\n\tevent.returnValue = gameReader.lastState;\n});\n\nipcMain.handle(IpcMessages.REQUEST_MOD, () => {\n\treturn gameReader.loadedMod.id;\n});\n\nipcMain.handle(IpcHandlerMessages.START_HOOK, async (event) => {\n\tif (!readingGame) {\n\t\treadingGame = true;\n\t\tlet speaking: number = 0\n\t\tresetKeyHooks();\n\n\t\tkeyboardWatcher.on('keydown', (keyId: number) => {\n\t\t\tif (keyCodeMatches(pushToTalkShortcut!, keyId)) {\n\t\t\t\tspeaking += 1;\n\t\t\t}\n\t\t\tif (keyCodeMatches(impostorRadioShortcut!, keyId) && gameReader.lastState.players?.find((value) => {return value.clientId === gameReader.lastState.clientId})?.isImpostor) {\n\t\t\t\tspeaking += 1;\n\t\t\t\tevent.sender.send(IpcRendererMessages.IMPOSTOR_RADIO, true);\n\t\t\t}\n\n\t\t\t// Cover weird cases which shouldn't happen but just in case\n\t\t\tif (speaking > 2) {\n\t\t\t\tspeaking = 2;\n\t\t\t}\n\t\t\tif (speaking) {\n\t\t\t\tevent.sender.send(IpcRendererMessages.PUSH_TO_TALK, true);\n\t\t\t}\n\t\t});\n\n\t\tkeyboardWatcher.on('keyup', (keyId: number) => {\n\t\t\tif (keyCodeMatches(pushToTalkShortcut!, keyId)) {\n\t\t\t\tspeaking -= 1;\n\t\t\t}\n\t\t\tif (keyCodeMatches(deafenShortcut!, keyId)) {\n\t\t\t\tevent.sender.send(IpcRendererMessages.TOGGLE_DEAFEN);\n\t\t\t}\n\t\t\tif (keyCodeMatches(muteShortcut!, keyId)) {\n\t\t\t\tevent.sender.send(IpcRendererMessages.TOGGLE_MUTE);\n\t\t\t}\n\t\t\tif (keyCodeMatches(impostorRadioShortcut!, keyId) && gameReader.lastState.players?.find((value) => {return value.clientId === gameReader.lastState.clientId})?.isImpostor) {\n\t\t\t\tspeaking -= 1;\n\t\t\t\tevent.sender.send(IpcRendererMessages.IMPOSTOR_RADIO, false);\n\t\t\t}\n\n\t\t\t// Cover weird cases which shouldn't happen but just in case\n\t\t\tif (speaking < 0) {\n\t\t\t\tspeaking = 0;\n\t\t\t}\n\t\t\tif (!speaking) {\n\t\t\t\tevent.sender.send(IpcRendererMessages.PUSH_TO_TALK, false);\n\t\t\t}\n\t\t});\n\n\t\tkeyboardWatcher.start();\n\n\t\t// Read game memory\n\t\tgameReader = new GameReader(event.sender.send.bind(event.sender));\n\t\tlet gotError = false;\n\t\tconst frame = async () => {\n\t\t\tconst err = await gameReader.loop();\n\t\t\tif (err) {\n\t\t\t\t// readingGame = false;\n\t\t\t\tgotError = true;\n\t\t\t\tevent.sender.send(IpcRendererMessages.ERROR, err);\n\t\t\t\tsetTimeout(frame, 7500);\n\t\t\t} else {\n\t\t\t\tif (gotError) {\n\t\t\t\t\tevent.sender.send(IpcRendererMessages.ERROR, '');\n\t\t\t\t\tgotError = false;\n\t\t\t\t}\n\n\t\t\t\tsetTimeout(frame, 1000 / 5);\n\t\t\t}\n\t\t};\n\t\tawait frame();\n\t} else if (gameReader) {\n\t\tgameReader.amongUs = null;\n\t\tgameReader.checkProcessDelay = 0;\n\t}\n});\n\nipcMain.on('reload', async (_, lobbybrowser) => {\n\tif (!lobbybrowser) {\n\t\tglobal.mainWindow?.reload();\n\t}\n\tglobal.lobbyBrowser?.reload();\n});\n\nipcMain.on('minimize', async (_, lobbybrowser) => {\n\tif (!lobbybrowser) {\n\t\tglobal.mainWindow?.minimize();\n\t}\n\tglobal.lobbyBrowser?.minimize();\n});\n\nipcMain.handle(\"getlocale\", () => {\n\treturn app.getLocale();\n});\n\nipcMain.on('relaunch', async () => {\n\tapp.relaunch();  \n\tapp.exit();\n});\n\nconst keycodeMap = {\n\tSpace: 0x20,\n\tBackspace: 0x08,\n\tDelete: 0x2e,\n\tEnter: 0x0d,\n\tUp: 0x26,\n\tDown: 0x28,\n\tLeft: 0x24,\n\tRight: 0x27,\n\tHome: 0x24,\n\tEnd: 0x23,\n\tPageUp: 0x21,\n\tPageDown: 0x22,\n\tEscape: 0x1b,\n\tControl: 0x11,\n\tLShift: 0xa0,\n\tRShift: 0xa1,\n\tRAlt: 0xa5,\n\tLAlt: 0xa4,\n\tRControl: 0xa3,\n\tLControl: 0xa2,\n\tShift: 0x10,\n\tAlt: 0x12,\n\tF1: 0x70,\n\tF2: 0x71,\n\tF3: 0x72,\n\tF4: 0x73,\n\tF5: 0x74,\n\tF6: 0x75,\n\tF7: 0x76,\n\tF8: 0x77,\n\tF9: 0x78,\n\tF10: 0x79,\n\tF11: 0x7a,\n\tF12: 0x7b,\n\tMouseButton4: 0x05,\n\tMouseButton5: 0x06,\n\tNumpad0: 0x60,\n\tNumpad1: 0x61,\n\tNumpad2: 0x62,\n\tNumpad3: 0x63,\n\tNumpad4: 0x64,\n\tNumpad5: 0x65,\n\tNumpad6: 0x66,\n\tNumpad7: 0x67,\n\tNumpad8: 0x68,\n\tNumpad9: 0x69,\n\tDisabled: -1,\n};\ntype K = keyof typeof keycodeMap;\n\nfunction keyCodeMatches(key: K, keyId: number): boolean {\n\tif (keycodeMap[key]) return keycodeMap[key] === keyId;\n\telse if (key && key.length === 1) return key.charCodeAt(0) === keyId;\n\telse {\n\t\tconsole.error('Invalid key', key);\n\t\treturn false;\n\t}\n}\n\nfunction addKeyHandler(key: K) {\n\tif (keycodeMap[key] && keycodeMap[key] !== -1) {\n\t\tkeyboardWatcher.addKeyHook(keycodeMap[key]);\n\t} else if (key && key.length === 1) {\n\t\tkeyboardWatcher.addKeyHook(key.charCodeAt(0));\n\t}\n}\n"]}