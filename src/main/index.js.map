{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["'use strict'; // eslint-disable-line\n\nimport { autoUpdater } from 'electron-updater';\nimport { app, BrowserWindow, ipcMain, session } from 'electron';\nimport windowStateKeeper from 'electron-window-state';\nimport { platform } from 'os';\nimport { join as joinPath } from 'path';\nimport { format as formatUrl } from 'url';\nimport './hook';\nimport { overlayWindow } from 'electron-overlay-window';\nimport { initializeIpcHandlers, initializeIpcListeners } from './ipc-handlers';\nimport { IpcRendererMessages, IpcHandlerMessages } from '../common/ipc-messages';\nimport { ProgressInfo, UpdateInfo } from 'builder-util-runtime';\nimport { protocol } from 'electron';\nimport Store from 'electron-store';\nimport { ISettings } from '../common/ISettings';\nimport installExtension, { REACT_DEVELOPER_TOOLS } from 'electron-devtools-installer';\nimport { gameReader } from './hook';\nimport { GenerateHat } from './avatarGenerator';\nconst args = require('minimist')(process.argv); // eslint-disable-line\nconst isDevelopment = process.env.NODE_ENV !== 'production';\nconst devTools = (isDevelopment || args.dev === 1) && true;\nconst appVersion: string = isDevelopment? \"DEV\" : autoUpdater.currentVersion.version;\n\ndeclare global {\n\tnamespace NodeJS {\n\t\t// eslint-disable-line\n\t\tinterface Global {\n\t\t\tmainWindow: BrowserWindow | null;\n\t\t\toverlay: BrowserWindow | null;\n\t\t\tlobbyBrowser: BrowserWindow | null;\n\t\t}\n\t}\n}\n// global reference to mainWindow (necessary to prevent window from being garbage collected)\nglobal.mainWindow = null;\nglobal.overlay = null;\nconst store = new Store<ISettings>();\napp.commandLine.appendSwitch('disable-pinch');\n\nif (platform() === 'linux' || !store.get('hardware_acceleration', true)) {\n\tapp.disableHardwareAcceleration();\n\n}\n\nif(platform() === 'linux'){\n\tapp.commandLine.appendSwitch('disable-gpu-sandbox');\n}\n\nfunction createMainWindow() {\n\tconst mainWindowState = windowStateKeeper({});\n\n\tconst window = new BrowserWindow({\n\t\ttitle: 'BetterCrewLink',\n\t\twidth: 250,\n\t\theight: 350,\n\t\tmaxWidth: 250,\n\t\tminWidth: 250,\n\t\tmaxHeight: 350,\n\t\tminHeight: 350,\n\t\tx: mainWindowState.x,\n\t\ty: mainWindowState.y,\n\t\tresizable: false,\n\t\tframe: false,\n\t\tfullscreenable: false,\n\t\tmaximizable: false,\n\t\twebPreferences: {\n\t\t\tnodeIntegration: true,\n\t\t\tcontextIsolation: false\n\t\t},\n\t});\n\tmainWindowState.manage(window);\n\n\tif (devTools) {\n\t\t//Force devtools into detached mode otherwise they are unusable\n\t\twindow.on('ready-to-show', () => {\n\t\t\twindow.webContents.openDevTools({\n\t\t\t\tmode: 'detach',\n\t\t\t});\n\t\t})\n\t}\n\n\tif (isDevelopment) {\n\t\twindow.loadURL(`http://localhost:${process.env.ELECTRON_WEBPACK_WDS_PORT}?version=DEV&view=app`);\n\t} else {\n\t\twindow.loadURL(\n\t\t\tformatUrl({\n\t\t\t\tpathname: joinPath(__dirname, 'index.html'),\n\t\t\t\tprotocol: 'file',\n\t\t\t\tquery: {\n\t\t\t\t\tversion: appVersion,\n\t\t\t\t\tview: 'app',\n\t\t\t\t},\n\t\t\t\tslashes: true,\n\t\t\t})\n\t\t);\n\t}\n\t//window.webContents.userAgent = `CrewLink/${crewlinkVersion} (${process.platform})`;\n\twindow.webContents.userAgent = `BetterCrewLink/${appVersion} (win32)`;\n\n\twindow.on('closed', () => {\n\t\ttry {\n\t\t\tconst mainWindow = global.mainWindow;\n\t\t\tconst overlay = global.overlay;\n\t\t\tglobal.mainWindow = null;\n\t\t\tglobal.overlay = null;\n\t\t\toverlay?.close();\n\t\t\tmainWindow?.destroy();\n\t\t\toverlay?.destroy();\n\t\t} catch {\n\t\t\t/* empty */\n\t\t}\n\t});\n\n\twindow.webContents.on('devtools-opened', () => {\n\t\twindow.focus();\n\t\tsetImmediate(() => {\n\t\t\twindow.focus();\n\t\t});\n\t});\n\tconsole.log('Opened app version: ', appVersion);\n\treturn window;\n}\n\nfunction createLobbyBrowser() {\n\tconst window = new BrowserWindow({\n\t\ttitle: 'BetterCrewLink Browser',\n\t\twidth: 900,\n\t\theight: 500,\n\t\tminWidth: 250,\n\t\tminHeight: 350,\n\t\tresizable: true,\n\t\tframe: false,\n\t\tfullscreenable: false,\n\t\tclosable: true,\n\t\tmaximizable: false,\n\t\twebPreferences: {\n\t\t\tnodeIntegration: true,\n\t\t\tcontextIsolation: false,\n\t\t},\n\t});\n\n\twindow.on('closed', () => {\n\t\tglobal.lobbyBrowser = null;\n\t});\n\t// if (devTools) {\n\t// \t// Force devtools into detached mode otherwise they are unusable\n\t// \twindow.webContents.openDevTools({\n\t// \t\tmode: 'detach',\n\t// \t});\n\t// }\n\tif (isDevelopment) {\n\t\twindow.loadURL(`http://localhost:${process.env.ELECTRON_WEBPACK_WDS_PORT}?version=DEV&view=lobbies`);\n\t} else {\n\t\twindow.loadURL(\n\t\t\tformatUrl({\n\t\t\t\tpathname: joinPath(__dirname, 'index.html'),\n\t\t\t\tprotocol: 'file',\n\t\t\t\tquery: {\n\t\t\t\t\tversion: appVersion,\n\t\t\t\t\tview: 'lobbies',\n\t\t\t\t},\n\t\t\t\tslashes: true,\n\t\t\t})\n\t\t);\n\t}\n\twindow.webContents.userAgent = `BetterCrewLink/${appVersion} (win32)`;\n\tconsole.log('Opened app version: ', appVersion);\n\treturn window;\n}\n\nfunction createOverlay() {\n\tconst overlay = new BrowserWindow({\n\t\ttitle: 'BetterCrewLink Overlay',\n\t\twidth: 400,\n\t\theight: 300,\n\t\twebPreferences: {\n\t\t\tnodeIntegration: true,\n\t\t\tcontextIsolation: false,\n\t\t},\n\t\tfullscreenable: true,\n\t\tskipTaskbar: true,\n\t\tframe: false,\n\t\tshow: false,\n\t\ttransparent: true,\n\t\tresizable: true,\n\t\tfocusable: false,\n\n\t\t//\t...overlayWindow.WINDOW_OPTS,\n\t});\n\n\tif (devTools) {\n\t\toverlay.webContents.openDevTools({\n\t\t\tmode: 'detach',\n\t\t});\n\t}\n\n\tif (isDevelopment) {\n\t\toverlay.loadURL(\n\t\t\t`http://localhost:${process.env.ELECTRON_WEBPACK_WDS_PORT}?version=${appVersion}&view=overlay`\n\t\t);\n\t} else {\n\t\toverlay.loadURL(\n\t\t\tformatUrl({\n\t\t\t\tpathname: joinPath(__dirname, 'index.html'),\n\t\t\t\tprotocol: 'file',\n\t\t\t\tquery: {\n\t\t\t\t\tversion: appVersion,\n\t\t\t\t\tview: 'overlay',\n\t\t\t\t},\n\t\t\t\tslashes: true,\n\t\t\t})\n\t\t);\n\t}\n\toverlay.setIgnoreMouseEvents(true);\n\toverlayWindow.attachTo(overlay, 'Among Us');\n\toverlay.setBackgroundColor('#00000000');\n\treturn overlay;\n}\n\nconst gotTheLock = app.requestSingleInstanceLock();\nif (!gotTheLock) {\n\tapp.quit();\n} else {\n\tautoUpdater.autoDownload = false;\n\tautoUpdater.checkForUpdates();\n\tautoUpdater.on('update-available', (info: UpdateInfo) => {\n\t\ttry {\n\t\t\tglobal.mainWindow?.webContents.send(IpcRendererMessages.AUTO_UPDATER_STATE, {\n\t\t\t\tstate: 'available',\n\t\t\t\tinfo: info,\n\t\t\t});\n\t\t} catch (e) {\n\t\t\t/* Empty block */\n\t\t}\n\t});\n\tautoUpdater.on('error', (err: string) => {\n\t\ttry {\n\t\t\tglobal.mainWindow?.webContents.send(IpcRendererMessages.AUTO_UPDATER_STATE, {\n\t\t\t\tstate: 'error',\n\t\t\t\terror: err,\n\t\t\t});\n\t\t} catch (e) {\n\t\t\t/*empty*/\n\t\t}\n\t});\n\tautoUpdater.on('download-progress', (progress: ProgressInfo) => {\n\t\ttry {\n\t\t\tglobal.mainWindow?.webContents.send(IpcRendererMessages.AUTO_UPDATER_STATE, {\n\t\t\t\tstate: 'downloading',\n\t\t\t\tprogress,\n\t\t\t});\n\t\t} catch (e) {\n\t\t\t/*empty*/\n\t\t}\n\t});\n\tautoUpdater.on('update-downloaded', () => {\n\t\tautoUpdater.quitAndInstall();\n\t});\n\n\t// quit application when all windows are closed\n\tapp.on('window-all-closed', () => {\n\t\t// on macOS it is common for applications to stay open until the user explicitly quits\n\t\ttry {\n\t\t\tconst mainWindow = global.mainWindow;\n\t\t\tconst overlay = global.overlay;\n\t\t\tglobal.mainWindow = null;\n\t\t\tglobal.overlay = null;\n\t\t\toverlay?.close();\n\t\t\tmainWindow?.destroy();\n\t\t\toverlay?.destroy();\n\t\t} catch {\n\t\t\t/* empty */\n\t\t}\n\t\tapp.quit();\n\t});\n\n\tapp.on('activate', () => {\n\t\tconsole.log(\"ACTIVATE???\")\n\t\t// on macOS it is common to re-create a window even after all windows have been closed\n\t\tif (global.mainWindow === null) {\n\t\t\tglobal.mainWindow = createMainWindow();\n\t\t}\n\n\t\tsession.fromPartition('default').setPermissionRequestHandler((webContents, permission, callback) => {\n\t\t\tconst allowedPermissions = ['audioCapture']; // Full list here: https://developer.chrome.com/extensions/declare_permissions#manifest\n\t\t\tconsole.log('permission requested ', permission);\n\t\t\tif (allowedPermissions.includes(permission)) {\n\t\t\t\tcallback(true); // Approve permission request\n\t\t\t} else {\n\t\t\t\tconsole.error(\n\t\t\t\t\t`The application tried to request permission for '${permission}'. This permission was not whitelisted and has been blocked.`\n\t\t\t\t);\n\n\t\t\t\tcallback(false); // Deny\n\t\t\t}\n\t\t});\n\t});\n\n\t// create main BrowserWindow when electron is ready\n\tapp.whenReady().then(() => {\n\t\tprotocol.registerFileProtocol('static', (request, callback) => {\n\t\t\tconst pathname = app.getPath('userData') + '/static/' + request.url.replace('static:///', '');\n\t\t\tcallback(pathname);\n\t\t});\n\n\t\tprotocol.registerFileProtocol('generate', async (request, callback) => {\n\t\t\tconst url = new URL(request.url.replace('generate:///', ''));\n\t\t\tconst path = await GenerateHat(url, gameReader.playercolors, Number(url.searchParams.get('color')), '');\n\t\t\tcallback(path);\n\t\t});\n\n\t\tinitializeIpcListeners();\n\t\tinitializeIpcHandlers();\n\t\tglobal.mainWindow = createMainWindow();\n\n\t\tif (isDevelopment)\n\t\t\tinstallExtension(REACT_DEVELOPER_TOOLS)\n\t\t\t\t.then((name: string) => console.log(`Added Extension:  ${name}`))\n\t\t\t\t.catch((err: string) => console.log('An error occurred: ', err));\n\t});\n\n\tapp.on('second-instance', () => {\n\t\t// Someone tried to run a second instance, we should focus our window.\n\t\tif (global.mainWindow) {\n\t\t\tif (global.mainWindow.isMinimized()) global.mainWindow.restore();\n\t\t\tglobal.mainWindow.focus();\n\t\t}\n\t});\n\n\tipcMain.on('update-app', () => {\n\t\tautoUpdater.downloadUpdate();\n\t});\n\n\tipcMain.on(IpcHandlerMessages.OPEN_LOBBYBROWSER, () => {\n\t\tif (!global.lobbyBrowser) {\n\t\t\tglobal.lobbyBrowser = createLobbyBrowser();\n\t\t} else {\n\t\t\tglobal.lobbyBrowser.show();\n\t\t\tglobal.lobbyBrowser.moveTop();\n\t\t}\n\t});\n\n\tipcMain.on('enableOverlay', async (_event, enable) => {\n\t\tsetTimeout(\n\t\t\t() => {\n\n\t\t\t\ttry {\n\t\t\t\t\tif (enable) {\n\t\t\t\t\t\tif (!global.overlay) {\n\t\t\t\t\t\t\tglobal.overlay = createOverlay();\n\t\t\t\t\t\t}\n\t\t\t\t\t\toverlayWindow.show();\n\t\t\t\t\t} else {\n\t\t\t\t\t\toverlayWindow.hide();\n\t\t\t\t\t\tif (global.overlay?.closable) {\n\t\t\t\t\t\t\toverlayWindow.stop();\n\t\t\t\t\t\t\tglobal.overlay?.close();\n\t\t\t\t\t\t\tglobal.overlay = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (exception) {\n\t\t\t\t\tglobal.overlay?.hide();\n\t\t\t\t\tglobal.overlay?.close();\n\t\t\t\t}\n\t\t\t},\n\t\t\t1000\n\t\t)\n\t});\n\n\tipcMain.on('setAlwaysOnTop', async (_event, enable) => {\n\t\tconsole.log(\"SETALWAYSONTOP?\")\n\t\tif (global.mainWindow) {\n\t\t\tconsole.log(\"SETALWAYSONTOP?1\")\n\t\t\tglobal.mainWindow.setAlwaysOnTop(enable, 'screen-saver');\n\t\t}\n\t});\n\n\n}\n"]}