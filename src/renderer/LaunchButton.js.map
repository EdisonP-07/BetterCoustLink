{"version":3,"file":"LaunchButton.js","sourceRoot":"","sources":["LaunchButton.tsx"],"names":[],"mappings":"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","sourcesContent":["import { ipcRenderer } from 'electron';\nimport React, { useContext, useEffect, useRef, useState } from 'react';\nimport { GamePlatformInstance, GamePlatformMap } from '../common/GamePlatform';\nimport { SettingsContext } from './contexts';\nimport makeStyles from '@mui/styles/makeStyles';\nimport { IpcMessages } from '../common/ipc-messages';\nimport { Button, ClickAwayListener, MenuItem, MenuList, Paper, Popper } from '@mui/material';\nimport { ToggleButton } from '@mui/material';\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';\nimport { CustomPlatformSettings } from './settings/CustomPlatformSettings';\n\nconst useStyles = makeStyles((theme) => ({\n\tbutton_group: {\n\t\tdisplay: 'inline-flex',\n\t\tmargin: '0px 10px',\n\t},\n\tbutton_primary: {\n\t\tcolor: 'white',\n\t\tbackground: 'none',\n\t\tpadding: '2px 10px',\n\t\tborderRadius: '10px 0px 0px 10px',\n\t\tborderWidth: '4px 2px 4px 4px',\n\t\tborderStyle: 'solid',\n\t\tborderColor: 'white',\n\t\tfontSize: 24,\n\t\toutline: 'none',\n\t\tfontWeight: 500,\n\t\tfontFamily: '\"Varela\", sans-serif',\n\t\t'&:hover': {\n\t\t\tborderColor: '#00ff00',\n\t\t\tcursor: 'pointer',\n\t\t},\n\t\ttextTransform: 'none',\n\t},\n\tbutton_dropdown: {\n\t\t'&.Mui-selected': {\n\t\t\tborderColor: '#00ff00',\n\t\t},\n\t\tcolor: 'white',\n\t\tbackground: 'none',\n\t\tpadding: '0px 0px',\n\t\tborderRadius: '0px 10px 10px 0px',\n\t\tborderWidth: '4px 4px 4px 2px',\n\t\tborderStyle: 'solid',\n\t\tborderColor: 'white',\n\t\t'&:hover': {\n\t\t\tborderColor: '#00ff00',\n\t\t\tcursor: 'pointer',\n\t\t},\n\t\tminWidth: '40px',\n\t},\n\tdropdown: {\n\t\tmaxHeight: 110,\n\t\toverflow: 'auto',\n\t\tborder: '1px solid rgba(255, 255, 255, 0.3)',\n\t\tbackground: '#272727',\n\t},\n}));\n\nexport interface LauncherProps {\n\tt: (key: string) => string;\n}\n\nconst LaunchButton: React.FC<LauncherProps> = function ({ t }: LauncherProps) {\n\tconst classes = useStyles();\n\n\tconst [settings, setSettings] = useContext(SettingsContext);\n\n\tconst [openMessage, setOpenMessage] = useState(<>{t('game.error_platform')}</>);\n\tconst [dropdownOpen, setDropdownOpen] = useState(false);\n\tconst [launchPlatforms, setLaunchPlatforms] = useState<GamePlatformMap>();\n\tconst [launchItemList, setLaunchItemList] = useState([] as JSX.Element[]);\n\tconst [customPlatformOpen, setCustomPlatformOpen] = useState(false);\n\tconst [customPlatformEdit, setCustomPlatformEdit] = useState((undefined as unknown) as GamePlatformInstance);\n\n\tconst anchorRef = useRef(null);\n\n\t// Grab available platforms from main thread\n\tuseEffect(() => {\n\t\tipcRenderer\n\t\t\t.invoke(IpcMessages.REQUEST_PLATFORMS_AVAILABLE, settings.customPlatforms)\n\t\t\t.then((result: GamePlatformMap) => {\n\t\t\t\tsetLaunchPlatforms(result);\n\t\t\t});\n\t}, [settings.customPlatforms]);\n\n\t// If launchPlatformSettings changes: select the first available platform and re-compute list of platforms\n\tuseEffect(() => {\n\t\tif (!launchPlatforms) return;\n\t\tif (!launchPlatforms[settings.launchPlatform]) {\n\t\t\tfor (const key in launchPlatforms) {\n\t\t\t\tsetSettings('launchPlatform', key);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Generate an array of <MenuItem>'s from available platforms for dropdown\n\t\tconst platformArray = Array.from(Object.keys(launchPlatforms)).reduce((filtered: JSX.Element[], key) => {\n\t\t\tconst platform = launchPlatforms[key];\n\t\t\tconst platformName = platform.default ? t(platform.translateKey) : platform.translateKey;\n\t\t\tfiltered.push(\n\t\t\t\t<MenuItem\n\t\t\t\t\tkey={platformName}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tsetSettings('launchPlatform', platform.key);\n\t\t\t\t\t\tsetDropdownOpen(false);\n\t\t\t\t\t}}\n\t\t\t\t\tonContextMenu={() => {\n\t\t\t\t\t\tif (platform.default) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetCustomPlatformEdit(platform);\n\t\t\t\t\t\tsetDropdownOpen(false);\n\t\t\t\t\t\tsetCustomPlatformOpen(true);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{platformName}\n\t\t\t\t</MenuItem>\n\t\t\t);\n\t\t\treturn filtered;\n\t\t}, []);\n\n\t\tplatformArray.push(\n\t\t\t<MenuItem\n\t\t\t\tkey={t('platform.custom')}\n\t\t\t\tonClick={() => {\n\t\t\t\t\tsetCustomPlatformEdit((undefined as unknown) as GamePlatformInstance);\n\t\t\t\t\tsetDropdownOpen(false);\n\t\t\t\t\tsetCustomPlatformOpen(true);\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{t('platform.custom')}\n\t\t\t</MenuItem>\n\t\t);\n\t\tsetLaunchItemList(platformArray);\n\t}, [launchPlatforms]);\n\n\t// Update button message when platform changes or no platforms are available (list empty)\n\tuseEffect(() => {\n\t\tif (!launchPlatforms) return;\n\t\tif (launchItemList.length > 1) {\n\t\t\tsetOpenMessage(<>{t(launchPlatforms[settings.launchPlatform].translateKey)}</>);\n\t\t} else {\n\t\t\tsetOpenMessage(<>{t('game.error_platform')}</>);\n\t\t}\n\t}, [launchItemList, settings.launchPlatform]);\n\n\treturn (\n\t\t<>\n\t\t\t<CustomPlatformSettings\n\t\t\t\tt={t}\n\t\t\t\topen={customPlatformOpen}\n\t\t\t\tsetOpenState={setCustomPlatformOpen}\n\t\t\t\teditPlatform={customPlatformEdit}\n\t\t\t/>\n\t\t\t<div className={classes.button_group} ref={anchorRef}>\n\t\t\t\t<Button\n\t\t\t\t\tclassName={classes.button_primary}\n\t\t\t\t\tdisabled={launchItemList.length === 1}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tipcRenderer.send(IpcMessages.OPEN_AMONG_US_GAME, launchPlatforms![settings.launchPlatform]);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{openMessage}\n\t\t\t\t</Button>\n\t\t\t\t<ToggleButton\n\t\t\t\t\tclassName={classes.button_dropdown}\n\t\t\t\t\tonClick={() => setDropdownOpen((status) => !status)}\n\t\t\t\t\tselected={dropdownOpen}\n\t\t\t\t\tvalue=\"\"\n\t\t\t\t>\n\t\t\t\t\t<ArrowDropDownIcon />\n\t\t\t\t</ToggleButton>\n\t\t\t</div>\n\t\t\t<Popper\n\t\t\t\topen={dropdownOpen}\n\t\t\t\tanchorEl={anchorRef.current}\n\t\t\t\tplacement=\"bottom-end\"\n\t\t\t\tdisablePortal={false}\n\t\t\t\tclassName={classes.dropdown}\n\t\t\t\tmodifiers={[\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"flip\",\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tenabled: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: \"preventOverflow\",\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tenabled: true,\n\t\t\t\t\t\t\tboundariesElement: 'viewport'\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t]}\n\t\t\t>\n\t\t\t\t<Paper>\n\t\t\t\t\t<ClickAwayListener onClickAway={() => setDropdownOpen(false)}>\n\t\t\t\t\t\t<MenuList>{launchItemList}</MenuList>\n\t\t\t\t\t</ClickAwayListener>\n\t\t\t\t</Paper>\n\t\t\t</Popper>\n\t\t</>\n\t);\n};\n\nexport default LaunchButton;\n"]}