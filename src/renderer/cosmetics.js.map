{"version":3,"file":"cosmetics.js","sourceRoot":"","sources":["cosmetics.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-ignore\nimport redAliveimg from '../../static/images/avatar/placeholder.png'; // @ts-ignore\nimport rainbowAliveimg from '../../static/images/avatar/rainbow-alive.png'; // @ts-ignore\nimport rainbowDeadeimg from '../../static/images/avatar/rainbow-dead.png';\n\nimport { ModsType } from '../common/Mods';\nexport const redAlive = redAliveimg;\n\nexport enum cosmeticType {\n\tbase,\n\that,\n\that_back,\n}\ninterface hatData {\n\timage: string;\n\tback_image: string;\n\ttop: string | undefined;\n\twidth: string | undefined;\n\tleft: string | undefined;\n\tmulti_color: boolean | undefined;\n\tmod: ModsType | undefined;\n}\nlet hatCollection: {\n\t[mod: string]: {\n\t\tdefaultWidth: string;\n\t\tdefaultTop: string;\n\t\tdefaultLeft: string;\n\t\thats: {\n\t\t\t[id: string]: hatData;\n\t\t};\n\t};\n} = {};\n\nexport interface HatDementions {\n\ttop: string;\n\tleft: string;\n\twidth: string;\n}\n\nlet requestingHats = false;\nexport var initializedHats = false;\n\nexport function initializeHats() {\n\tif (initializedHats || requestingHats) {\n\t\treturn;\n\t}\n\trequestingHats = true;\n\tfetch(`${HAT_COLLECTION_URL}/hats.json`)\n\t\t.then((response) => response.json())\n\t\t.then((data) => {\n\t\t\thatCollection = data;\n\t\t\tinitializedHats = true;\n\t\t});\n\treturn undefined;\n}\n\nconst HAT_COLLECTION_URL =  'https://cdn.jsdelivr.net/gh/OhMyGuus/BetterCrewLink-Hats@master/'; //'https://raw.githubusercontent.com/OhMyGuus/BetterCrewlink-Hats/master';\nfunction getModHat(color: number, id = '', mod: ModsType, back = false) {\n\tif (!initializedHats) {\n\t\treturn '';\n\t}\n\tconst hatBase = getHat(id, mod);\n\tconst hat = back ? hatBase?.back_image : hatBase?.image;\n\tconst multiColor = hatBase?.multi_color;\n\tif (hat && hatBase) {\n\t\tif (!multiColor) return `${HAT_COLLECTION_URL}${hatBase.mod}/${hat}`;\n\t\telse return `generate:///${HAT_COLLECTION_URL}${hatBase.mod}/${hat}?color=${color}`;\n\t}\n\treturn undefined;\n}\n\n\n\nfunction getHat(id: string, modType: ModsType): hatData | undefined {\n\tif (!initializedHats) {\n\t\treturn undefined;\n\t}\n\tfor (const mod of ['NONE' as ModsType, modType]) {\n\t\tconst modHatList = hatCollection[mod];\n\t\tconst hat = modHatList?.hats[id];\n\t\tif (hat) {\n\t\t\that.top = hat?.top ?? modHatList?.defaultTop;\n\t\t\that.width = hat?.width ?? modHatList?.defaultWidth;\n\t\t\that.left = hat?.left ?? modHatList?.defaultLeft;\n\t\t\that.mod = mod;\n\t\t\treturn hat;\n\t\t}\n\t}\n\treturn undefined;\n}\n\nexport function getHatDementions(id: string, mod: ModsType): HatDementions {\n\tconst hat = getHat(id, mod);\n\treturn {\n\t\ttop: hat?.top ?? '0',\n\t\twidth: hat?.width ?? '0',\n\t\tleft: hat?.left ?? '0',\n\t};\n}\n\nexport const RainbowColorId = -99234;\nexport function getCosmetic(\n\tcolor: number,\n\tisAlive: boolean,\n\ttype: cosmeticType,\n\tid = '',\n\tmod: ModsType = 'NONE'\n): string {\n\tif (type === cosmeticType.base) {\n\t\tif (color == RainbowColorId) {\n\t\t\treturn isAlive ? rainbowAliveimg : rainbowDeadeimg;\n\t\t}\n\t\treturn `static:///generated/${isAlive ? `player` : `ghost`}/${color}.png`;\n\t} else {\n\t\tconst modHat = getModHat(color, id, mod, type === cosmeticType.hat_back);\n\t\tif (modHat) return modHat;\n\t}\n\treturn '';\n}\n"]}