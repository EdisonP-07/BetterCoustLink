{"version":3,"file":"ServerURLInput.js","sourceRoot":"","sources":["ServerURLInput.tsx"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AACnD,OAAO,KAAK,MAAM,qBAAqB,CAAC;AACxC,OAAO,EAAE,aAAa,EAAE,WAAW,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,MAAM,eAAe,CAAC;AACrG,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,MAAM,WAAW,CAAC;AASlD,SAAS,iBAAiB,CAAC,GAAW;IACrC,IAAI;QACH,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC;YAAE,OAAO,KAAK,CAAC;QACtD,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC;QACzB,IAAI,GAAG,CAAC,QAAQ,KAAK,YAAY;YAAE,OAAO,KAAK,CAAC;QAChD,IAAI,GAAG,CAAC,QAAQ,KAAK,GAAG;YAAE,OAAO,KAAK,CAAC;QACvC,OAAO,IAAI,CAAC;KACZ;IAAC,OAAO,CAAC,EAAE;QACX,OAAO,KAAK,CAAC;KACb;AACF,CAAC;AAED,MAAM,iBAAiB,GAA4B,UAAU,EAAE,CAAC,EAAE,UAAU,EAAE,UAAU,EAAE,SAAS,EAAiB;IACnH,MAAM,CAAC,UAAU,EAAE,WAAW,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;IACjD,MAAM,CAAC,UAAU,EAAE,aAAa,CAAC,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC;IACzD,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;IAExC,SAAS,CAAC,GAAG,EAAE;QACd,aAAa,CAAC,UAAU,CAAC,CAAC;IAC3B,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;IAEjB,SAAS,YAAY,CAAC,KAA0C;QAC/D,MAAM,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;QACtC,aAAa,CAAC,GAAG,CAAC,CAAC;QACnB,IAAI,iBAAiB,CAAC,GAAG,CAAC,EAAE;YAC3B,WAAW,CAAC,IAAI,CAAC,CAAC;SAClB;aAAM;YACN,WAAW,CAAC,KAAK,CAAC,CAAC;SACnB;IACF,CAAC;IAED,OAAO,CACN;QACC,oBAAC,MAAM,IAAC,OAAO,EAAC,WAAW,EAAC,KAAK,EAAC,WAAW,EAAC,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,IACxE,CAAC,CAAC,iCAAiC,CAAC,CAC7B;QACT,oBAAC,MAAM,IAAC,UAAU,QAAC,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC;YAC3D;gBACC,oBAAC,WAAW,QAAE,CAAC,CAAC,iCAAiC,CAAC,CAAe,CAC5D;YACN,oBAAC,aAAa,IAAC,SAAS,EAAE,SAAS;gBAClC,oBAAC,SAAS,IACT,SAAS,QACT,KAAK,EAAE,CAAC,UAAU,EAClB,UAAU,EAAE,KAAK,EACjB,KAAK,EAAE,CAAC,CAAC,gCAAgC,CAAC,EAC1C,KAAK,EAAE,UAAU,EACjB,QAAQ,EAAE,YAAY,EACtB,OAAO,EAAC,UAAU,EAClB,KAAK,EAAC,SAAS,EACf,UAAU,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,gCAAgC,CAAC,GAChE;gBACF,oBAAC,KAAK,IAAC,QAAQ,EAAC,OAAO,IAAE,CAAC,CAAC,wCAAwC,CAAC,CAAS;gBAC7E,oBAAC,MAAM,IACN,KAAK,EAAC,SAAS,EACf,OAAO,EAAC,WAAW,EACnB,OAAO,EAAE,GAAG,EAAE;wBACb,OAAO,CAAC,KAAK,CAAC,CAAC;wBACf,WAAW,CAAC,IAAI,CAAC,CAAC;wBAClB,UAAU,CAAC,yBAAyB,CAAC,CAAC;oBACvC,CAAC,IAEA,CAAC,CAAC,iCAAiC,CAAC,CAC7B,CACM;YAChB,oBAAC,aAAa;gBACb,oBAAC,MAAM,IACN,KAAK,EAAC,SAAS,EACf,OAAO,EAAE,GAAG,EAAE;wBACb,WAAW,CAAC,IAAI,CAAC,CAAC;wBAClB,OAAO,CAAC,KAAK,CAAC,CAAC;wBACf,aAAa,CAAC,UAAU,CAAC,CAAC;oBAC3B,CAAC,IAEA,CAAC,CAAC,gBAAgB,CAAC,CACZ;gBACT,oBAAC,MAAM,IACN,QAAQ,EAAE,CAAC,UAAU,EACrB,KAAK,EAAC,SAAS,EACf,OAAO,EAAE,GAAG,EAAE;wBACb,OAAO,CAAC,KAAK,CAAC,CAAC;wBACf,IAAI,GAAG,GAAG,UAAU,CAAC;wBACrB,IAAI,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC;4BAAE,GAAG,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;wBAC9D,UAAU,CAAC,GAAG,CAAC,CAAC;oBACjB,CAAC,IAEA,CAAC,CAAC,iBAAiB,CAAC,CACb,CACM,CACR,CACP,CACH,CAAC;AACH,CAAC,CAAC;AAEF,MAAM,cAAc,GAAG,KAAK,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;AAErD,eAAe,cAAc,CAAC","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Alert from '@mui/material/Alert';\nimport { DialogContent, DialogTitle, DialogActions, Dialog, Button, TextField } from '@mui/material';\nimport { isHttpUri, isHttpsUri } from 'valid-url';\n\ntype URLInputProps = {\n\tt: (key: string) => string;\n\tinitialURL: string;\n\tonValidURL: (url: string) => void;\n\tclassName: string;\n};\n\nfunction validateServerUrl(uri: string): boolean {\n\ttry {\n\t\tif (!isHttpUri(uri) && !isHttpsUri(uri)) return false;\n\t\tconst url = new URL(uri);\n\t\tif (url.hostname === 'discord.gg') return false;\n\t\tif (url.pathname !== '/') return false;\n\t\treturn true;\n\t} catch (_) {\n\t\treturn false;\n\t}\n}\n\nconst RawServerURLInput: React.FC<URLInputProps> = function ({ t, initialURL, onValidURL, className }: URLInputProps) {\n\tconst [isValidURL, setURLValid] = useState(true);\n\tconst [currentURL, setCurrentURL] = useState(initialURL);\n\tconst [open, setOpen] = useState(false);\n\n\tuseEffect(() => {\n\t\tsetCurrentURL(initialURL);\n\t}, [initialURL]);\n\n\tfunction handleChange(event: React.ChangeEvent<HTMLInputElement>) {\n\t\tconst url = event.target.value.trim();\n\t\tsetCurrentURL(url);\n\t\tif (validateServerUrl(url)) {\n\t\t\tsetURLValid(true);\n\t\t} else {\n\t\t\tsetURLValid(false);\n\t\t}\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<Button variant=\"contained\" color=\"secondary\" onClick={() => setOpen(true)}>\n\t\t\t\t{t('settings.advanced.change_server')}\n\t\t\t</Button>\n\t\t\t<Dialog fullScreen open={open} onClose={() => setOpen(false)}>\n\t\t\t\t<div>\n\t\t\t\t\t<DialogTitle>{t('settings.advanced.change_server')}</DialogTitle>\n\t\t\t\t</div>\n\t\t\t\t<DialogContent className={className}>\n\t\t\t\t\t<TextField\n\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\terror={!isValidURL}\n\t\t\t\t\t\tspellCheck={false}\n\t\t\t\t\t\tlabel={t('settings.advanced.voice_server')}\n\t\t\t\t\t\tvalue={currentURL}\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\thelperText={isValidURL ? '' : t('settings.advanced.voice_server')}\n\t\t\t\t\t/>\n\t\t\t\t\t<Alert severity=\"error\">{t('settings.advanced.voice_server_warning')}</Alert>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\tvariant=\"contained\"\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tsetOpen(false);\n\t\t\t\t\t\t\tsetURLValid(true);\n\t\t\t\t\t\t\tonValidURL('https://bettercrewl.ink');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('settings.advanced.reset_default')}\n\t\t\t\t\t</Button>\n\t\t\t\t</DialogContent>\n\t\t\t\t<DialogActions>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tsetURLValid(true);\n\t\t\t\t\t\t\tsetOpen(false);\n\t\t\t\t\t\t\tsetCurrentURL(initialURL);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('buttons.cancel')}\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tdisabled={!isValidURL}\n\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tsetOpen(false);\n\t\t\t\t\t\t\tlet url = currentURL;\n\t\t\t\t\t\t\tif (url.endsWith('/')) url = url.substring(0, url.length - 1);\n\t\t\t\t\t\t\tonValidURL(url);\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{t('buttons.confirm')}\n\t\t\t\t\t</Button>\n\t\t\t\t</DialogActions>\n\t\t\t</Dialog>\n\t\t</>\n\t);\n};\n\nconst ServerURLInput = React.memo(RawServerURLInput);\n\nexport default ServerURLInput;\n"]}