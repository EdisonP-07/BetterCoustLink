{"version":3,"file":"Voice.js","sourceRoot":"","sources":["Voice.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useMemo, useRef, useState } from 'react';\nimport io, { Socket } from 'socket.io-client';\nimport Avatar from './Avatar';\nimport { GameStateContext, HostSettingsContext, PlayerColorContext, SettingsContext } from './contexts';\nimport {\n\tAmongUsState,\n\tGameState,\n\tPlayer,\n\tSocketClientMap,\n\tAudioConnected,\n\tClientBoolMap,\n\tnumberStringMap,\n\tClient,\n\tVoiceState,\n} from '../common/AmongUsState';\nimport Peer from 'simple-peer';\nimport { ipcRenderer } from 'electron';\nimport VAD from './vad';\nimport { ISettings, playerConfigMap, ILobbySettings } from '../common/ISettings';\nimport { IpcRendererMessages, IpcMessages, IpcOverlayMessages, IpcHandlerMessages } from '../common/ipc-messages';\nimport Typography from '@mui/material/Typography';\nimport Grid from '@mui/material/Grid';\nimport makeStyles from '@mui/styles/makeStyles';\nimport SupportLink from './SupportLink';\nimport Divider from '@mui/material/Divider';\nimport { validateClientPeerConfig } from './validateClientPeerConfig';\n// @ts-ignore\nimport reverbOgx from 'arraybuffer-loader!../../static/sounds/reverb.ogx'; // @ts-ignore\nimport radioOnSound from '../../static/sounds/radio_on.wav'; // @ts-ignore\n\nimport { CameraLocation, AmongUsMaps, MapType } from '../common/AmongusMap';\nimport { ObsVoiceState } from '../common/ObsOverlay';\nimport Footer from './Footer';\nimport Button from '@mui/material/Button';\nimport IconButton from '@mui/material/IconButton';\nimport VolumeOff from '@mui/icons-material/VolumeOff';\nimport VolumeUp from '@mui/icons-material/VolumeUp';\nimport Mic from '@mui/icons-material/Mic';\nimport MicOff from '@mui/icons-material/MicOff';\nimport adapter from 'webrtc-adapter';\nimport { VADOptions } from './vad';\nimport { pushToTalkOptions } from './settings/SettingsStore';\nimport { poseCollide } from '../common/ColliderMap';\n\nconsole.log(adapter.browserDetails.browser);\n\nexport interface ExtendedAudioElement extends HTMLAudioElement {\n\tsetSinkId: (sinkId: string) => Promise<void>;\n}\n\ninterface PeerConnections {\n\t[peer: string]: Peer.Instance;\n}\n\ninterface VadNode {\n\tconnect: () => void;\n\tdestroy: () => void;\n\toptions: VADOptions;\n\tinit: () => void;\n}\n\ninterface AudioNodes {\n\tdummyAudioElement: HTMLAudioElement;\n\taudioElement: HTMLAudioElement;\n\tgain: GainNode;\n\tpan: PannerNode;\n\treverb: ConvolverNode;\n\tmuffle: BiquadFilterNode;\n\tdestination: AudioNode;\n\treverbConnected: boolean;\n\tmuffleConnected: boolean;\n}\n\ninterface AudioElements {\n\t[peer: string]: AudioNodes;\n}\n\ninterface ConnectionStuff {\n\tsocket?: typeof Socket;\n\toverlaySocket?: typeof Socket;\n\tstream?: MediaStream;\n\tinstream?: MediaStream;\n\n\tmicrophoneGain?: GainNode;\n\taudioListener?: VadNode;\n\tpushToTalkMode: number;\n\tdeafened: boolean;\n\tmuted: boolean;\n\timpostorRadio: boolean | null;\n\ttoggleMute: () => void;\n\ttoggleDeafen: () => void;\n}\n\ninterface SocketError {\n\tmessage?: string;\n}\n\ninterface ClientPeerConfig {\n\tforceRelayOnly: boolean;\n\ticeServers: RTCIceServer[];\n}\n\nconst DEFAULT_ICE_CONFIG: RTCConfiguration = {\n\ticeTransportPolicy: 'all',\n\ticeServers: [\n\t\t{\n\t\t\turls: 'stun:stun.l.google.com:19302',\n\t\t},\n\t],\n};\n\nconst DEFAULT_ICE_CONFIG_TURN: RTCConfiguration = {\n\ticeTransportPolicy: 'relay',\n\ticeServers: [\n\t\t{\n\t\t\turls: 'turn:turn.bettercrewl.ink:3478',\n\t\t\tusername: 'M9DRVaByiujoXeuYAAAG',\n\t\t\tcredential: 'TpHR9HQNZ8taxjb3',\n\t\t},\n\t],\n};\n\nexport interface VoiceProps {\n\tt: (key: string) => string;\n\terror: string;\n}\n\nconst useStyles = makeStyles((theme) => ({\n\terror: {\n\t\tposition: 'absolute',\n\t\ttop: '50%',\n\t\ttransform: 'translateY(-50%)',\n\t},\n\troot: {\n\t\tpaddingTop: theme.spacing(3),\n\t},\n\ttop: {\n\t\tdisplay: 'flex',\n\t\tjustifyContent: 'center',\n\t\talignItems: 'center',\n\t},\n\tright: {\n\t\tdisplay: 'flex',\n\t\tflexDirection: 'column',\n\t\talignItems: 'center',\n\t\tjustifyContent: 'center',\n\t},\n\tusername: {\n\t\tdisplay: 'block',\n\t\ttextAlign: 'center',\n\t\tfontSize: 20,\n\t\twhiteSpace: 'nowrap',\n\t\tmaxWidth: '115px',\n\t},\n\tcode: {\n\t\tfontFamily: \"'Source Code Pro', monospace\",\n\t\tdisplay: 'block',\n\t\twidth: 'fit-content',\n\t\tmargin: '5px auto',\n\t\tpadding: 5,\n\t\tborderRadius: 5,\n\t\tfontSize: 28,\n\t},\n\totherplayers: {\n\t\twidth: 225,\n\t\theight: 225,\n\t\tmargin: '4px auto',\n\t\t'& .MuiGrid-grid-xs-1': {\n\t\t\tmaxHeight: '8.3333333%',\n\t\t},\n\t\t'& .MuiGrid-grid-xs-2': {\n\t\t\tmaxHeight: '16.666667%',\n\t\t},\n\t\t'& .MuiGrid-grid-xs-3': {\n\t\t\tmaxHeight: '25%',\n\t\t},\n\t\t'& .MuiGrid-grid-xs-4': {\n\t\t\tmaxHeight: '33.333333%',\n\t\t},\n\t},\n\tavatarWrapper: {\n\t\twidth: 80,\n\t\tpadding: theme.spacing(1),\n\t},\n\tmuteButtons: {\n\t\tpaddingLeft: '5px',\n\t\tpaddingTop: '26px',\n\t\tfloat: 'right',\n\t\tdisplay: 'grid',\n\t},\n\tleft: { float: 'left' },\n}));\n\nconst defaultlocalLobbySettings: ILobbySettings = {\n\tmaxDistance: 5.32,\n\thaunting: false,\n\thearImpostorsInVents: false,\n\timpostersHearImpostersInvent: false,\n\timpostorRadioEnabled: false,\n\tcommsSabotage: false,\n\tdeadOnly: false,\n\thearThroughCameras: false,\n\twallsBlockAudio: false,\n\tmeetingGhostOnly: false,\n\tvisionHearing: false,\n\tpublicLobby_on: false,\n\tpublicLobby_title: '',\n\tpublicLobby_language: 'en',\n};\nconst radioOnAudio = new Audio();\nradioOnAudio.src = radioOnSound;\nradioOnAudio.volume = 0.02;\n\n// const radiobeepAudio2 = new Audio();\n// radiobeepAudio2.src = radioBeep2;\n// radiobeepAudio2.volume = 0.2;\n\nconst Voice: React.FC<VoiceProps> = function ({ t, error: initialError }: VoiceProps) {\n\tconst [error, setError] = useState('');\n\tconst [settings, setSetting] = useContext(SettingsContext);\n\n\tconst settingsRef = useRef<ISettings>(settings);\n\tconst [lobbySettings, setHostLobbySettings] = useContext(HostSettingsContext);\n\tconst lobbySettingsRef = useRef(lobbySettings);\n\tconst maxDistanceRef = useRef(2);\n\tconst gameState = useContext(GameStateContext);\n\tconst playerColors = useContext(PlayerColorContext);\n\n\tconst hostRef = useRef({\n\t\tmap: MapType.UNKNOWN,\n\t\tmobileRunning: false,\n\t\tgamestate: gameState.gameState,\n\t\tcode: gameState.lobbyCode,\n\t\thostId: gameState.hostId,\n\t\tparsedHostId: gameState.hostId,\n\t\tisHost: gameState.isHost,\n\t\tserverHostId: 0,\n\t});\n\tlet { lobbyCode: displayedLobbyCode } = gameState;\n\tif (displayedLobbyCode !== 'MENU' && settings.hideCode) displayedLobbyCode = 'LOBBY';\n\tconst [talking, setTalking] = useState(false);\n\tconst [socketClients, setSocketClients] = useState<SocketClientMap>({});\n\tconst [playerConfigs] = useState<playerConfigMap>(settingsRef.current.playerConfigMap);\n\tconst socketClientsRef = useRef(socketClients);\n\tconst [peerConnections, setPeerConnections] = useState<PeerConnections>({});\n\tconst convolverBuffer = useRef<AudioBuffer | null>(null);\n\tconst playerSocketIdsRef = useRef<numberStringMap>({});\n\tconst classes = useStyles();\n\n\tconst [connect, setConnect] = useState<{\n\t\tconnect: (lobbyCode: string, playerId: number, clientId: number, isHost: boolean) => void;\n\t} | null>(null);\n\tconst [otherTalking, setOtherTalking] = useState<ClientBoolMap>({});\n\tconst [otherVAD, setOtherVAD] = useState<ClientBoolMap>({});\n\n\tconst [otherDead, setOtherDead] = useState<ClientBoolMap>({});\n\tconst impostorRadioClientId = useRef<number>(-1);\n\n\tconst audioElements = useRef<AudioElements>({});\n\tconst [audioConnected, setAudioConnected] = useState<AudioConnected>({});\n\n\tconst [deafenedState, setDeafened] = useState(false);\n\tconst [mutedState, setMuted] = useState(false);\n\tconst [connected, setConnected] = useState(false);\n\n\tfunction applyEffect(gain: AudioNode, effectNode: AudioNode, destination: AudioNode, player: Player) {\n\t\tconsole.log('Apply effect->', effectNode);\n\t\ttry {\n\t\t\tgain.disconnect(destination);\n\t\t\tgain.connect(effectNode);\n\t\t\teffectNode.connect(destination);\n\t\t} catch {\n\t\t\tconsole.log('error with applying effect: ', player.name, effectNode);\n\t\t}\n\t}\n\n\tfunction restoreEffect(gain: AudioNode, effectNode: AudioNode, destination: AudioNode, player: Player) {\n\t\tconsole.log('restore effect->', effectNode);\n\t\ttry {\n\t\t\teffectNode.disconnect(destination);\n\t\t\tgain.disconnect(effectNode);\n\t\t\tgain.connect(destination);\n\t\t} catch {\n\t\t\tconsole.log('error with applying effect: ', player.name, effectNode);\n\t\t}\n\t}\n\tfunction calculateVoiceAudio(\n\t\tstate: AmongUsState,\n\t\tsettings: ISettings,\n\t\tme: Player,\n\t\tother: Player,\n\t\taudio: AudioNodes\n\t): number {\n\t\tconst { pan, gain, muffle, reverb, destination } = audio;\n\t\tconst audioContext = pan.context;\n\t\tconst useLightSource = true;\n\t\tlet maxdistance = maxDistanceRef.current;\n\t\tlet panPos = [other.x - me.x, other.y - me.y];\n\t\tlet endGain = 0;\n\t\tlet collided = false;\n\t\tlet skipDistanceCheck = false;\n\t\tlet muffleEnabled = false;\n\n\t\tif (other.disconnected || other.isDummy) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tswitch (state.gameState) {\n\t\t\tcase GameState.MENU:\n\t\t\t\treturn 0;\n\t\t\tcase GameState.LOBBY:\n\t\t\t\tendGain = 1;\n\t\t\t\tbreak;\n\n\t\t\tcase GameState.TASKS:\n\t\t\t\tendGain = 1;\n\n\t\t\t\tif (lobbySettings.meetingGhostOnly) {\n\t\t\t\t\tendGain = 0;\n\t\t\t\t}\n\t\t\t\tif (!me.isDead && lobbySettings.commsSabotage && state.comsSabotaged && !me.isImpostor) {\n\t\t\t\t\tendGain = 0;\n\t\t\t\t}\n\n\t\t\t\t// Mute other players which are in a vent\n\t\t\t\tif (\n\t\t\t\t\tother.inVent &&\n\t\t\t\t\t!(lobbySettings.hearImpostorsInVents || (lobbySettings.impostersHearImpostersInvent && me.inVent))\n\t\t\t\t) {\n\t\t\t\t\tendGain = 0;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tlobbySettings.wallsBlockAudio &&\n\t\t\t\t\t!me.isDead &&\n\t\t\t\t\tposeCollide({ x: me.x, y: me.y }, { x: other.x, y: other.y }, gameState.map, gameState.closedDoors)\n\t\t\t\t) {\n\t\t\t\t\tcollided = true;\n\t\t\t\t}\n\t\t\t\tif (\n\t\t\t\t\tme.isImpostor &&\n\t\t\t\t\tother.isImpostor &&\n\t\t\t\t\tlobbySettings.impostorRadioEnabled &&\n\t\t\t\t\tother.clientId === impostorRadioClientId.current\n\t\t\t\t) {\n\t\t\t\t\tskipDistanceCheck = true;\n\t\t\t\t\tmuffle.type = 'highpass';\n\t\t\t\t\tmuffle.frequency.value = 1000;\n\t\t\t\t\tmuffle.Q.value = 10;\n\t\t\t\t\tmuffleEnabled = true;\n\t\t\t\t\tif (!audio.muffleConnected) {\n\t\t\t\t\t\taudio.muffleConnected = true;\n\t\t\t\t\t\tapplyEffect(gain, muffle, destination, other);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!me.isDead && other.isDead && me.isImpostor && lobbySettings.haunting) {\n\t\t\t\t\tif (!audio.reverbConnected) {\n\t\t\t\t\t\taudio.reverbConnected = true;\n\t\t\t\t\t\tapplyEffect(gain, reverb, destination, other);\n\t\t\t\t\t}\n\t\t\t\t\tcollided = false;\n\t\t\t\t\tendGain = settings.ghostVolumeAsImpostor / 100;\n\t\t\t\t} else {\n\t\t\t\t\tif (other.isDead && !me.isDead) {\n\t\t\t\t\t\tendGain = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase GameState.DISCUSSION:\n\t\t\t\tpanPos = [0, 0];\n\t\t\t\tendGain = 1;\n\t\t\t\tif (!me.isDead && other.isDead) {\n\t\t\t\t\tendGain = 0;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase GameState.UNKNOWN:\n\t\t\tdefault:\n\t\t\t\tendGain = 0;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (useLightSource && state.lightRadiusChanged) {\n\t\t\tpan.maxDistance = maxDistanceRef.current;\n\t\t}\n\n\t\tif (!other.isDead || state.gameState !== GameState.TASKS || !me.isImpostor || me.isDead) {\n\t\t\tif (audio.reverbConnected && reverb) {\n\t\t\t\taudio.reverbConnected = false;\n\t\t\t\trestoreEffect(gain, reverb, destination, other);\n\t\t\t}\n\t\t}\n\n\t\tif (lobbySettings.deadOnly) {\n\t\t\tpanPos = [0, 0];\n\t\t\tif (!me.isDead || !other.isDead) {\n\t\t\t\tendGain = 0;\n\t\t\t}\n\t\t}\n\n\t\tlet isOnCamera = state.currentCamera !== CameraLocation.NONE;\n\t\tif (!skipDistanceCheck && Math.sqrt(panPos[0] * panPos[0] + panPos[1] * panPos[1]) > maxdistance) {\n\t\t\tif (lobbySettings.hearThroughCameras && state.gameState === GameState.TASKS) {\n\t\t\t\tif (state.currentCamera !== CameraLocation.NONE && state.currentCamera !== CameraLocation.Skeld) {\n\t\t\t\t\tconst camerapos = AmongUsMaps[state.map].cameras[state.currentCamera];\n\t\t\t\t\tpanPos = [other.x - camerapos.x, other.y - camerapos.y];\n\t\t\t\t\tconsole.log('camerapos: ', camerapos);\n\t\t\t\t} else if (state.currentCamera === CameraLocation.Skeld) {\n\t\t\t\t\tlet distance = 999;\n\t\t\t\t\tlet camerapos = { x: 999, y: 999 };\n\t\t\t\t\tfor (const camera of Object.values(AmongUsMaps[state.map].cameras)) {\n\t\t\t\t\t\tconst cameraDist = Math.sqrt(Math.pow(other.x - camera.x, 2) + Math.pow(other.y - camera.y, 2));\n\t\t\t\t\t\tif (distance > cameraDist) {\n\t\t\t\t\t\t\tdistance = cameraDist;\n\t\t\t\t\t\t\tcamerapos = camera;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (distance != 999) {\n\t\t\t\t\t\tpanPos = [other.x - camerapos.x, other.y - camerapos.y];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Math.sqrt(panPos[0] * panPos[0] + panPos[1] * panPos[1]) > maxdistance) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} else {\n\t\t\tif (collided && !skipDistanceCheck) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tisOnCamera = false;\n\t\t}\n\n\t\t// Muffling in vents\n\t\tif (\n\t\t\t((me.inVent && !me.isDead) || (other.inVent && !other.isDead) || isOnCamera) &&\n\t\t\tstate.gameState === GameState.TASKS\n\t\t) {\n\t\t\tif (!audio.muffleConnected) {\n\t\t\t\taudio.muffleConnected = true;\n\t\t\t\tapplyEffect(gain, muffle, destination, other);\n\t\t\t}\n\t\t\tmaxdistance = isOnCamera ? 3 : 0.8;\n\t\t\tmuffle.frequency.value = isOnCamera ? 2300 : 2000;\n\t\t\tmuffle.Q.value = isOnCamera ? -15 : 20;\n\t\t\tif (endGain === 1) endGain = isOnCamera ? 0.8 : 0.5; // Too loud at 1\n\t\t} else {\n\t\t\tif (audio.muffleConnected && !muffleEnabled) {\n\t\t\t\taudio.muffleConnected = false;\n\t\t\t\trestoreEffect(gain, muffle, destination, other);\n\t\t\t}\n\t\t}\n\n\t\tif (!settings.enableSpatialAudio || skipDistanceCheck) {\n\t\t\tpanPos = [0, 0];\n\t\t}\n\n\t\tpan.positionX.setValueAtTime(panPos[0], audioContext.currentTime);\n\t\tpan.positionY.setValueAtTime(panPos[1], audioContext.currentTime);\n\t\tpan.positionZ.setValueAtTime(-0.5, audioContext.currentTime);\n\t\treturn endGain;\n\t}\n\n\tfunction notifyMobilePlayers() {\n\t\tif (\n\t\t\tsettingsRef.current.mobileHost &&\n\t\t\thostRef.current.gamestate !== GameState.MENU &&\n\t\t\thostRef.current.gamestate !== GameState.UNKNOWN\n\t\t) {\n\t\t\tconnectionStuff.current.socket?.emit('signal', {\n\t\t\t\tto: hostRef.current.code + '_mobile',\n\t\t\t\tdata: { mobileHostInfo: { isHostingMobile: true, isGameHost: hostRef.current.isHost } },\n\t\t\t});\n\t\t}\n\t\tsetTimeout(() => notifyMobilePlayers(), 5000);\n\t}\n\n\tfunction disconnectAudioHtmlElement(element: HTMLAudioElement) {\n\t\tconsole.log('disableing element?', element);\n\t\telement.pause();\n\t\tif (element.srcObject) {\n\t\t\tconst mediaStream = element.srcObject as MediaStream;\n\t\t\tmediaStream.getTracks().forEach((track) => track.stop());\n\t\t}\n\t\telement.removeAttribute('srcObject');\n\t\telement.removeAttribute('src');\n\t\telement.srcObject = null;\n\t\telement.load();\n\t\telement.remove();\n\t}\n\tfunction disconnectAudioElement(peer: string) {\n\t\tif (audioElements.current[peer]) {\n\t\t\tconsole.log('removing element..');\n\t\t\tdisconnectAudioHtmlElement(audioElements.current[peer].audioElement);\n\t\t\tdisconnectAudioHtmlElement(audioElements.current[peer].dummyAudioElement);\n\t\t\taudioElements.current[peer].pan.disconnect();\n\t\t\taudioElements.current[peer].gain.disconnect();\n\t\t\t// if (audioElements.current[peer].reverbGain != null) audioElements.current[peer].reverbGain?.disconnect();\n\t\t\tif (audioElements.current[peer].reverb != null) audioElements.current[peer].reverb?.disconnect();\n\t\t\tdelete audioElements.current[peer];\n\t\t}\n\t}\n\n\tfunction disconnectClient(client: Client) {\n\t\tif (!client || !client.clientId)\n\t\t\treturn;\n\t\tconst oldSocketId = playerSocketIdsRef.current[client.clientId];\n\t\tconsole.log(\"Checking for  old connection ....\", client.clientId, oldSocketId)\n\t\tif (oldSocketId && audioElements.current[oldSocketId]) {\n\t\t\tconsole.log(\"found old connection disconnecting....\", client.clientId)\n\t\t\tdisconnectAudioElement(oldSocketId);\n\t\t}\n\t}\n\n\tfunction disconnectPeer(peer: string) {\n\t\tconsole.log('Disconnect peer: ', peer);\n\t\tconst connection = peerConnections[peer];\n\t\tif (!connection) {\n\t\t\treturn;\n\t\t}\n\t\tconnection.destroy();\n\t\tsetPeerConnections((connections) => {\n\t\t\tdelete connections[peer];\n\t\t\treturn connections;\n\t\t});\n\t\tdisconnectAudioElement(peer);\n\t}\n\t// Handle pushToTalk, if set\n\tuseEffect(() => {\n\t\tif (!connectionStuff.current.instream) return;\n\t\tconnectionStuff.current.instream.getAudioTracks()[0].enabled =\n\t\t\t!connectionStuff.current.deafened &&\n\t\t\t!connectionStuff.current.muted &&\n\t\t\tsettings.pushToTalkMode !== pushToTalkOptions.PUSH_TO_TALK;\n\t\tconnectionStuff.current.pushToTalkMode = settings.pushToTalkMode;\n\t}, [settings.pushToTalkMode]);\n\n\t// Emit lobby settings to connected peers\n\tuseEffect(() => {\n\t\tif (hostRef.current.isHost !== true) return;\n\t\tObject.values(peerConnections).forEach((peer) => {\n\t\t\ttry {\n\t\t\t\tconsole.log('sendxx > ', JSON.stringify(settings.localLobbySettings));\n\t\t\t\tpeer.send(JSON.stringify(settings.localLobbySettings));\n\t\t\t} catch (e) {\n\t\t\t\tconsole.warn('failed to update lobby settings: ', e);\n\t\t\t}\n\t\t});\n\n\t\tsetHostLobbySettings(settings.localLobbySettings);\n\t}, [settings.localLobbySettings, hostRef.current.isHost]);\n\n\tuseEffect(() => {\n\t\tfor (const peer in audioElements.current) {\n\t\t\taudioElements.current[peer].pan.maxDistance = maxDistanceRef.current;\n\t\t}\n\t}, [lobbySettings.maxDistance, lobbySettings.visionHearing]);\n\n\tuseEffect(() => {\n\t\tif (\n\t\t\t!gameState ||\n\t\t\t!gameState.players ||\n\t\t\t!connectionStuff.current.socket ||\n\t\t\t(!hostRef.current.mobileRunning && !settings.obsOverlay)\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\tif (hostRef.current.mobileRunning) {\n\t\t\tconnectionStuff.current.socket?.emit('signal', {\n\t\t\t\tto: gameState.lobbyCode + '_mobile',\n\t\t\t\tdata: { gameState, lobbySettings },\n\t\t\t});\n\t\t}\n\n\t\tif (\n\t\t\tsettings.obsOverlay &&\n\t\t\tsettings.obsSecret &&\n\t\t\tsettings.obsSecret.length === 9 &&\n\t\t\t((gameState.gameState !== GameState.UNKNOWN && gameState.gameState !== GameState.MENU) ||\n\t\t\t\tgameState.oldGameState !== gameState.gameState)\n\t\t) {\n\t\t\tconnectionStuff.current.overlaySocket = connectionStuff.current.socket;\n\n\t\t\tconst obsvoiceState: ObsVoiceState = {\n\t\t\t\toverlayState: {\n\t\t\t\t\tgameState: gameState.gameState,\n\t\t\t\t\tplayers: gameState.players.map((o) => ({\n\t\t\t\t\t\tid: o.id,\n\t\t\t\t\t\tclientId: o.clientId,\n\t\t\t\t\t\tinVent: o.inVent,\n\t\t\t\t\t\tisDead: o.isDead,\n\t\t\t\t\t\tname: o.name,\n\t\t\t\t\t\tcolorId: o.colorId,\n\t\t\t\t\t\thatId: o.hatId,\n\t\t\t\t\t\tpetId: o.petId,\n\t\t\t\t\t\tskinId: o.skinId,\n\t\t\t\t\t\tvisorId: o.visorId,\n\t\t\t\t\t\tdisconnected: o.disconnected,\n\t\t\t\t\t\tisLocal: o.isLocal,\n\t\t\t\t\t\tshiftedColor: o.shiftedColor,\n\t\t\t\t\t\tbugged: o.bugged,\n\t\t\t\t\t\trealColor: playerColors[o.colorId],\n\t\t\t\t\t\tusingRadio: o.clientId === impostorRadioClientId.current && myPlayer?.isImpostor,\n\t\t\t\t\t\tconnected:\n\t\t\t\t\t\t\t(playerSocketIdsRef.current[o.clientId] &&\n\t\t\t\t\t\t\t\tsocketClients[playerSocketIdsRef.current[o.clientId]]?.clientId === o.clientId) ||\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t})),\n\t\t\t\t},\n\t\t\t\totherTalking,\n\t\t\t\totherDead,\n\t\t\t\tlocalTalking: talking,\n\t\t\t\tlocalIsAlive: !myPlayer?.isDead,\n\t\t\t\tmod: gameState.mod,\n\t\t\t\toldMeetingHud: gameState.oldMeetingHud,\n\t\t\t};\n\t\t\tconnectionStuff.current.overlaySocket?.emit('signal', {\n\t\t\t\tto: settings.obsSecret,\n\t\t\t\tdata: obsvoiceState,\n\t\t\t});\n\t\t}\n\t}, [gameState]);\n\n\t// Add settings to settingsRef\n\tuseEffect(() => {\n\t\tsettingsRef.current = settings;\n\t}, [settings]);\n\n\t// Add socketClients to socketClientsRef\n\tuseEffect(() => {\n\t\tsocketClientsRef.current = socketClients;\n\t}, [socketClients]);\n\n\tuseEffect(() => {\n\t\tif (\n\t\t\tconnectionStuff.current?.microphoneGain?.gain &&\n\t\t\t(settingsRef.current.microphoneGainEnabled || settingsRef.current.micSensitivityEnabled)\n\t\t) {\n\t\t\tif (!settingsRef.current.micSensitivityEnabled)\n\t\t\t\tconnectionStuff.current.microphoneGain.gain.value = settings.microphoneGainEnabled\n\t\t\t\t\t? settings.microphoneGain / 100\n\t\t\t\t\t: 1;\n\n\t\t\tif (connectionStuff.current?.audioListener?.options) {\n\t\t\t\tconnectionStuff.current.audioListener.options.minNoiseLevel = settings.micSensitivity;\n\t\t\t\tconnectionStuff.current.audioListener.init();\n\t\t\t}\n\t\t}\n\t}, [settings.microphoneGain, settings.micSensitivity]);\n\n\tconst updateLobby = () => {\n\t\tconsole.log(gameState);\n\t\tif (\n\t\t\t!gameState ||\n\t\t\t!hostRef.current.isHost ||\n\t\t\t!gameState.lobbyCode ||\n\t\t\tgameState.gameState === GameState.MENU ||\n\t\t\t!gameState.players\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\tconnectionStuff.current.socket?.emit('lobby', gameState.lobbyCode, {\n\t\t\tid: -1,\n\t\t\ttitle: lobbySettings.publicLobby_title,\n\t\t\thost: myPlayer?.name,\n\t\t\tcurrent_players: gameState.players.length,\n\t\t\tmax_players: gameState.maxPlayers,\n\t\t\tserver: gameState.currentServer,\n\t\t\tlanguage: lobbySettings.publicLobby_language,\n\t\t\tmods: gameState.mod,\n\t\t\tisPublic: lobbySettings.publicLobby_on,\n\t\t\tgameState: gameState.gameState,\n\t\t});\n\t};\n\n\tuseEffect(() => {\n\t\tif (gameState.isHost && gameState.hostId > 0) {\n\t\t\tconnectionStuff.current.socket?.emit('setHost', gameState.lobbyCode, gameState.clientId);\n\t\t\thostRef.current.serverHostId = gameState.hostId;\n\t\t}\n\t}, [gameState.isHost]);\n\n\tuseEffect(() => {\n\t\tupdateLobby();\n\t}, [\n\t\tgameState.gameState,\n\t\tgameState?.players?.length,\n\t\tlobbySettings.publicLobby_title,\n\t\tlobbySettings.publicLobby_language,\n\t\tlobbySettings.publicLobby_on,\n\t]);\n\n\t// Add lobbySettings to lobbySettingsRef\n\tuseEffect(() => {\n\t\tlobbySettingsRef.current = lobbySettings;\n\t}, [lobbySettings]);\n\n\n\n\t// Set dead player data\n\tuseEffect(() => {\n\t\tif (gameState.gameState === GameState.LOBBY) {\n\t\t\tsetOtherDead({});\n\t\t} else if (gameState.gameState !== GameState.TASKS) {\n\t\t\tif (!gameState.players) return;\n\t\t\tsetOtherDead((old) => {\n\t\t\t\tfor (const player of gameState.players) {\n\t\t\t\t\told[player.clientId] = player.isDead || player.disconnected;\n\t\t\t\t}\n\t\t\t\treturn { ...old };\n\t\t\t});\n\t\t}\n\t}, [gameState.gameState]);\n\n\t// const [audioContext] = useState<AudioContext>(() => new AudioContext());\n\tconst connectionStuff = useRef<ConnectionStuff>({\n\t\tpushToTalkMode: settings.pushToTalkMode,\n\t\tdeafened: false,\n\t\tmuted: false,\n\t\timpostorRadio: null,\n\t\ttoggleMute: () => {\n\t\t\t/*empty*/\n\t\t},\n\t\ttoggleDeafen: () => {\n\t\t\t/*empty*/\n\t\t},\n\t});\n\n\tuseEffect(() => {\n\t\t(async () => {\n\t\t\tconst context = new AudioContext();\n\t\t\tconvolverBuffer.current = await context.decodeAudioData(reverbOgx);\n\t\t\tawait context.close();\n\t\t})();\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst pressing = connectionStuff.current.impostorRadio;\n\t\tif (\n\t\t\tpressing == null ||\n\t\t\t!myPlayer ||\n\t\t\t!myPlayer.isImpostor ||\n\t\t\tmyPlayer.isDead ||\n\t\t\t!(impostorRadioClientId.current === myPlayer.clientId || impostorRadioClientId.current === -1) ||\n\t\t\t!lobbySettingsRef.current.impostorRadioEnabled\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\tradioOnAudio.play();\n\t\tconnectionStuff.current.impostorRadio = pressing;\n\t\timpostorRadioClientId.current = pressing ? myPlayer.clientId : -1;\n\t\tfor (const player of otherPlayers.filter((o) => o.isImpostor && !o.bugged && !o.isDead)) {\n\t\t\tconst peer = playerSocketIdsRef.current[player.clientId];\n\t\t\tconst connection = peerConnections[peer];\n\t\t\tif (connection !== undefined && connection.writable)\n\t\t\t\tconnection?.send(JSON.stringify({ impostorRadio: connectionStuff.current.impostorRadio }));\n\t\t}\n\t}, [connectionStuff.current.impostorRadio]);\n\n\tuseEffect(() => {\n\t\t// (async function anyNameFunction() {\n\t\tlet currentLobby = '';\n\t\t// Connect to voice relay server\n\t\tconnectionStuff.current.socket = io(settings.serverURL,{\n\t\t\ttransports: ['websocket']\n\t\t });\n\n\t\tconst { socket } = connectionStuff.current;\n\n\t\tsocket.on('error', (error: SocketError) => {\n\t\t\tif (error.message) {\n\t\t\t\tsetError(error.message);\n\t\t\t}\n\t\t\tconsole.error('socketIO error:', error);\n\t\t\tcurrentLobby = 'MENU';\n\t\t});\n\t\tsocket.on('connect', () => {\n\t\t\tsetConnected(true);\n\t\t\tconsole.log('CONNECTED??');\n\t\t});\n\n\t\tsocket.on('setHost', (hostId: number) => {\n\t\t\thostRef.current.serverHostId = hostId;\n\t\t});\n\n\t\tsocket.on('disconnect', () => {\n\t\t\tsetConnected(false);\n\t\t\tcurrentLobby = 'MENU';\n\t\t\tconsole.log('DISCONNECTED??');\n\t\t});\n\n\t\tnotifyMobilePlayers();\n\n\t\tlet iceConfig: RTCConfiguration = DEFAULT_ICE_CONFIG;\n\t\tsocket.on('clientPeerConfig', (clientPeerConfig: ClientPeerConfig) => {\n\t\t\tif (!validateClientPeerConfig(clientPeerConfig)) {\n\t\t\t\tlet errorsFormatted = '';\n\t\t\t\tif (validateClientPeerConfig.errors) {\n\t\t\t\t\terrorsFormatted = validateClientPeerConfig.errors\n\t\t\t\t\t\t.map((error) => error.dataPath + ' ' + error.message)\n\t\t\t\t\t\t.join('\\n');\n\t\t\t\t}\n\t\t\t\talert(\n\t\t\t\t\t`Server sent a malformed peer config. Default config will be used. See errors below:\\n${errorsFormatted}`\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tclientPeerConfig.forceRelayOnly &&\n\t\t\t\t!clientPeerConfig.iceServers.some((server) => server.urls.toString().includes('turn:'))\n\t\t\t) {\n\t\t\t\talert('Server has forced relay mode enabled but provides no relay servers. Default config will be used.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ticeConfig = {\n\t\t\t\ticeTransportPolicy: clientPeerConfig.forceRelayOnly ? 'relay' : 'all',\n\t\t\t\ticeServers: clientPeerConfig.iceServers,\n\t\t\t};\n\t\t});\n\n\t\tsocket.on('VAD', (data: { activity: boolean; client: Client; socketId: string }) => {\n\t\t\tsetOtherVAD((old) => ({\n\t\t\t\t...old,\n\t\t\t\t[data.client.clientId]: data.activity,\n\t\t\t}));\n\t\t});\n\n\t\tsocket.on('setClient', (socketId: string, client: Client) => {\n\t\t\tsetSocketClients((old) => ({ ...old, [socketId]: client }));\n\t\t});\n\n\t\tsocket.on('setClients', (clients: SocketClientMap) => {\n\t\t\tsetSocketClients(clients);\n\t\t});\n\n\t\t// Initialize variables\n\t\tlet audioListener: VadNode;\n\n\t\tconst audio: MediaTrackConstraintSet = {\n\t\t\tdeviceId: (undefined as unknown) as string,\n\t\t\tautoGainControl: false,\n\t\t\tchannelCount: 2,\n\t\t\techoCancellation: settings.echoCancellation,\n\t\t\tlatency: 0,\n\t\t\tnoiseSuppression: settings.noiseSuppression,// @ts-ignore-line\n\t\t\tgoogNoiseSuppression: settings.noiseSuppression, // @ts-ignore-line\n\t\t\tgoogEchoCancellation: settings.echoCancellation, // @ts-ignore-line\n\t\t\tgoogTypingNoiseDetection: settings.noiseSuppression, // @ts-ignore-line\n\t\t\tsampleRate: settings.oldSampleDebug? 48000 : undefined,\n\t\t\tsampleSize: settings.oldSampleDebug? 16 : undefined,\n\t\t};\n\n\t\t// Get microphone settings\n\t\tif (settingsRef.current.microphone.toLowerCase() !== 'default') audio.deviceId = settingsRef.current.microphone;\n\t\tnavigator.mediaDevices.getUserMedia({ video: false, audio })\n\t\t.then(async (inStream) => {\n\t\t\tlet stream = inStream;\n\t\t\tconst ac = new AudioContext();\n\t\t\tlet microphoneGain: GainNode | undefined;\n\t\t\tconst source = ac.createMediaStreamSource(inStream);\n\t\t\tif (settings.microphoneGainEnabled || settings.micSensitivityEnabled) {\n\t\t\t\tconsole.log('Microphone volume or sensitivityEnabled..');\n\t\t\t\tstream = (() => {\n\t\t\t\t\tmicrophoneGain = ac.createGain();\n\t\t\t\t\tconst destination = ac.createMediaStreamDestination();\n\t\t\t\t\tsource.connect(microphoneGain);\n\t\t\t\t\tmicrophoneGain.gain.value = settings.microphoneGainEnabled ? settings.microphoneGain / 100 : 1;\n\t\t\t\t\tmicrophoneGain.connect(destination);\n\t\t\t\t\tconnectionStuff.current.microphoneGain = microphoneGain;\n\t\t\t\t\treturn destination.stream;\n\t\t\t\t})();\n\t\t\t}\n\n\t\t\tif (settingsRef.current.vadEnabled) {\n\t\t\t\taudioListener = VAD(ac, source, undefined, {\n\t\t\t\t\tonVoiceStart: () => {\n\t\t\t\t\t\tif (microphoneGain && settingsRef.current.micSensitivityEnabled) {\n\t\t\t\t\t\t\tmicrophoneGain.gain.value = settingsRef.current.microphoneGainEnabled\n\t\t\t\t\t\t\t\t? settingsRef.current.microphoneGain / 100\n\t\t\t\t\t\t\t\t: 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTalking(true);\n\t\t\t\t\t},\n\t\t\t\t\tonVoiceStop: () => {\n\t\t\t\t\t\tif (microphoneGain && settingsRef.current.micSensitivityEnabled) {\n\t\t\t\t\t\t\tmicrophoneGain.gain.value = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetTalking(false);\n\t\t\t\t\t},\n\t\t\t\t\tnoiseCaptureDuration: 0,\n\t\t\t\t\tstereo: false,\n\t\t\t\t});\n\n\t\t\t\taudioListener.options.minNoiseLevel = settingsRef.current.micSensitivityEnabled\n\t\t\t\t\t? settingsRef.current.micSensitivity\n\t\t\t\t\t: 0.15;\n\t\t\t\taudioListener.options.maxNoiseLevel = 1;\n\n\t\t\t\taudioListener.init();\n\t\t\t\tconnectionStuff.current.audioListener = audioListener;\n\t\t\t\tconnectionStuff.current.microphoneGain = microphoneGain;\n\t\t\t}\n\t\t\tconnectionStuff.current.stream = stream;\n\t\t\tconnectionStuff.current.instream = inStream;\n\n\t\t\tinStream.getAudioTracks()[0].enabled = settings.pushToTalkMode !== pushToTalkOptions.PUSH_TO_TALK;\n\n\t\t\tconnectionStuff.current.toggleDeafen = () => {\n\t\t\t\tconnectionStuff.current.deafened = !connectionStuff.current.deafened;\n\t\t\t\tinStream.getAudioTracks()[0].enabled =\n\t\t\t\t\t!connectionStuff.current.deafened &&\n\t\t\t\t\t!connectionStuff.current.muted &&\n\t\t\t\t\tconnectionStuff.current.pushToTalkMode !== pushToTalkOptions.PUSH_TO_TALK;\n\t\t\t\tsetDeafened(connectionStuff.current.deafened);\n\t\t\t};\n\n\t\t\tconnectionStuff.current.toggleMute = () => {\n\t\t\t\tconnectionStuff.current.muted = !connectionStuff.current.muted;\n\t\t\t\tif (connectionStuff.current.deafened) {\n\t\t\t\t\tconnectionStuff.current.deafened = false;\n\t\t\t\t\tconnectionStuff.current.muted = false;\n\t\t\t\t}\n\t\t\t\tinStream.getAudioTracks()[0].enabled =\n\t\t\t\t\t!connectionStuff.current.muted &&\n\t\t\t\t\t!connectionStuff.current.deafened &&\n\t\t\t\t\tconnectionStuff.current.pushToTalkMode !== pushToTalkOptions.PUSH_TO_TALK;\n\t\t\t\tsetMuted(connectionStuff.current.muted);\n\t\t\t\tsetDeafened(connectionStuff.current.deafened);\n\t\t\t};\n\n\t\t\tipcRenderer.on(IpcRendererMessages.TOGGLE_DEAFEN, connectionStuff.current.toggleDeafen);\n\n\t\t\tipcRenderer.on(IpcRendererMessages.IMPOSTOR_RADIO, (_: unknown, pressing: boolean) => {\n\t\t\t\tconnectionStuff.current.impostorRadio = pressing;\n\t\t\t});\n\n\t\t\tipcRenderer.on(IpcRendererMessages.TOGGLE_MUTE, connectionStuff.current.toggleMute);\n\t\t\tipcRenderer.on(IpcRendererMessages.PUSH_TO_TALK, (_: unknown, pressing: boolean) => {\n\t\t\t\tif (connectionStuff.current.pushToTalkMode === pushToTalkOptions.VOICE) return;\n\t\t\t\tif (!connectionStuff.current.deafened && !connectionStuff.current.muted) {\n\t\t\t\t\tinStream.getAudioTracks()[0].enabled =\n\t\t\t\t\t\tconnectionStuff.current.pushToTalkMode === pushToTalkOptions.PUSH_TO_TALK ? pressing : !pressing;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\taudioElements.current = {};\n\n\t\t\tconst connect = (lobbyCode: string, playerId: number, clientId: number, isHost: boolean) => {\n\t\t\t\tconsole.log('connect called..', lobbyCode);\n\t\t\t\tsetOtherVAD({});\n\t\t\t\tsetOtherTalking({});\n\t\t\t\tif (lobbyCode === 'MENU') {\n\t\t\t\t\tObject.keys(peerConnections).forEach((k) => {\n\t\t\t\t\t\tdisconnectPeer(k);\n\t\t\t\t\t});\n\t\t\t\t\tsetSocketClients({});\n\t\t\t\t\tcurrentLobby = lobbyCode;\n\t\t\t\t} else if (currentLobby !== lobbyCode) {\n\t\t\t\t\tconsole.log('Currentlobby', currentLobby, lobbyCode);\n\t\t\t\t\tsocket.emit('leave');\n\t\t\t\t\tsocket.emit('id', playerId, clientId);\n\t\t\t\t\tsocket.emit('join', lobbyCode, playerId, clientId, isHost);\n\t\t\t\t\tcurrentLobby = lobbyCode;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tsetConnect({ connect });\n\n\t\t\tfunction createPeerConnection(peer: string, initiator: boolean, client: Client) {\n\t\t\t\tconsole.log('CreatePeerConnection: ', peer, initiator);\n\t\t\t\tdisconnectClient(client);\n\t\t\t\tconst connection = new Peer({\n\t\t\t\t\tstream,\n\t\t\t\t\tinitiator, // @ts-ignore-line\n\t\t\t\t\ticeRestartEnabled: true,\n\t\t\t\t\tconfig: settingsRef.current.natFix ? DEFAULT_ICE_CONFIG_TURN : iceConfig,\n\t\t\t\t});\n\n\t\t\t\tsetPeerConnections((connections) => {\n\t\t\t\t\tconnections[peer] = connection;\n\t\t\t\t\treturn connections;\n\t\t\t\t});\n\n\t\t\t\tconnection.on('connect', () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tif (hostRef.current.isHost && connection.writable) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconsole.log('sending settings..');\n\t\t\t\t\t\t\t\tconnection.send(JSON.stringify(lobbySettingsRef.current));\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tconsole.warn('failed to update lobby settings: ', e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 1000);\n\t\t\t\t});\n\n\t\t\t\tconnection.on('stream', async (stream: MediaStream) => {\n\t\t\t\t\tconsole.log('ONSTREAM');\n\n\t\t\t\t\tsetAudioConnected((old) => ({ ...old, [peer]: true }));\n\t\t\t\t\tconst dummyAudio = new Audio();\n\t\t\t\t\tdummyAudio.srcObject = stream;\n\t\t\t\t\tconst context = new AudioContext();\n\t\t\t\t\tconst source = context.createMediaStreamSource(stream);\n\t\t\t\t\tconst dest = context.createMediaStreamDestination();\n\n\t\t\t\t\tconst gain = context.createGain();\n\t\t\t\t\tconst pan = context.createPanner();\n\t\t\t\t\tgain.gain.value = 0;\n\t\t\t\t\tpan.refDistance = 0.1;\n\t\t\t\t\tpan.panningModel = 'equalpower';\n\t\t\t\t\tpan.distanceModel = 'linear';\n\t\t\t\t\tpan.maxDistance = maxDistanceRef.current;\n\t\t\t\t\tpan.rolloffFactor = 1;\n\n\t\t\t\t\tconst muffle = context.createBiquadFilter();\n\t\t\t\t\tmuffle.type = 'lowpass';\n\n\t\t\t\t\tsource.connect(pan);\n\t\t\t\t\tpan.connect(gain);\n\n\t\t\t\t\tconst reverb = context.createConvolver();\n\t\t\t\t\treverb.buffer = convolverBuffer.current;\n\t\t\t\t\tconst destination: AudioNode = dest;\n\t\t\t\t\t// if (settingsRef.current.vadEnabled) {\n\t\t\t\t\t// \tVAD(context, gain, undefined, {\n\t\t\t\t\t// \t\tonVoiceStart: () => setTalking(true),\n\t\t\t\t\t// \t\tonVoiceStop: () => setTalking(false),\n\t\t\t\t\t// \t\tstereo: false,\n\t\t\t\t\t// \t});\n\t\t\t\t\t// }\n\t\t\t\t\tgain.connect(destination);\n\t\t\t\t\tconst audio = document.createElement('audio') as ExtendedAudioElement;\n\t\t\t\t\tdocument.body.appendChild(audio);\n\t\t\t\t\taudio.setAttribute('autoplay', '');\n\t\t\t\t\taudio.srcObject = dest.stream;\n\t\t\t\t\tif (settingsRef.current.speaker.toLowerCase() !== 'default') {\n\t\t\t\t\t\taudio.setSinkId(settingsRef.current.speaker);\n\t\t\t\t\t}\n\n\n\t\t\t\t\taudioElements.current[peer] = {\n\t\t\t\t\t\tdummyAudioElement: dummyAudio,\n\t\t\t\t\t\taudioElement: audio,\n\t\t\t\t\t\tgain,\n\t\t\t\t\t\tpan,\n\t\t\t\t\t\treverb,\n\t\t\t\t\t\tmuffle,\n\t\t\t\t\t\tmuffleConnected: false,\n\t\t\t\t\t\treverbConnected: false,\n\t\t\t\t\t\tdestination,\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tconnection.on('signal', (data) => {\n\t\t\t\t\tsocket.emit('signal', {\n\t\t\t\t\t\tdata,\n\t\t\t\t\t\tto: peer,\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tconnection.on('data', (data) => {\n\t\t\t\t\tconst parsedData = JSON.parse(data);\n\t\t\t\t\tif (parsedData.hasOwnProperty('impostorRadio')) {\n\t\t\t\t\t\tconst clientId = socketClientsRef.current[peer]?.clientId;\n\t\t\t\t\t\tif (impostorRadioClientId.current === -1 && parsedData['impostorRadio']) {\n\t\t\t\t\t\t\timpostorRadioClientId.current = clientId;\n\t\t\t\t\t\t} else if (impostorRadioClientId.current === clientId && !parsedData['impostorRadio']) {\n\t\t\t\t\t\t\timpostorRadioClientId.current = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log('Recieved impostor radio request', parsedData);\n\t\t\t\t\t}\n\t\t\t\t\tif (parsedData.hasOwnProperty('maxDistance')) {\n\t\t\t\t\t\tif (!hostRef.current || hostRef.current.parsedHostId !== socketClientsRef.current[peer]?.clientId) return;\n\t\t\t\t\t\tconst newSettings = {...defaultlocalLobbySettings, ...parsedData};\n\t\t\t\t\t\tsetHostLobbySettings(newSettings);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tconnection.on('close', () => {\n\t\t\t\t\tconsole.log('Disconnected from', peer, 'Initiator:', initiator);\n\t\t\t\t\tdisconnectPeer(peer);\n\t\t\t\t});\n\t\t\t\tconnection.on('error', () => {\n\t\t\t\t\tconsole.log('ONERROR');\n\t\t\t\t\t/*empty*/\n\t\t\t\t});\n\t\t\t\treturn connection;\n\t\t\t}\n\n\t\t\tsocket.on('join', async (peer: string, client: Client) => {\n\t\t\t\tcreatePeerConnection(peer, true, client);\n\t\t\t\tsetSocketClients((old) => ({ ...old, [peer]: client }));\n\t\t\t});\n\n\t\t\tsocket.on('signal', ({ data, from, client }: { data: Peer.SignalData; from: string, client: Client }) => {\n\t\t\t\tif (data.hasOwnProperty('mobilePlayerInfo')) {\n\t\t\t\t\t// eslint-disable-line\n\t\t\t\t\tconst mobiledata = data as mobileHostInfo;\n\t\t\t\t\tif (\n\t\t\t\t\t\tmobiledata.mobilePlayerInfo.code === hostRef.current.code &&\n\t\t\t\t\t\thostRef.current.gamestate !== GameState.MENU\n\t\t\t\t\t) {\n\t\t\t\t\t\thostRef.current.mobileRunning = true;\n\t\t\t\t\t\tconsole.log('setting mobileRunning to true..');\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet connection: Peer.Instance;\n\t\t\t\tif (!socketClientsRef.current[from]) {\n\t\t\t\t\tconsole.warn('SIGNAL FROM UNKOWN SOCKET..');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (data.hasOwnProperty('type')) {\n\t\t\t\t\tif (peerConnections[from] && data.type !== 'offer') {\n\t\t\t\t\t\tconnection = peerConnections[from];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconnection = createPeerConnection(from, false, client);\n\t\t\t\t\t}\n\t\t\t\t\tconnection.signal(data);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t(error) => {\n\t\t\tconsole.error(error);\n\t\t\tsetError(\"Couldn't connect to your microphone:\\n\" + error);\n\t\t\t// ipcRenderer.send(IpcMessages.SHOW_ERROR_DIALOG, {\n\t\t\t// \ttitle: 'Error',\n\t\t\t// \tcontent: 'Couldn\\'t connect to your microphone:\\n' + error\n\t\t\t// });\n\t\t});\n\n\t\treturn () => {\n\t\t\thostRef.current.mobileRunning = false;\n\t\t\tsocket.emit('leave');\n\t\t\tObject.keys(peerConnections).forEach((k) => {\n\t\t\t\tdisconnectPeer(k);\n\t\t\t});\n\t\t\tconnectionStuff.current.socket?.close();\n\n\t\t\taudioListener?.destroy();\n\t\t};\n\t\t// })();\n\t}, []);\n\n\tinterface mobileHostInfo {\n\t\tmobilePlayerInfo: {\n\t\t\tcode: string;\n\t\t\taskingForHost: boolean;\n\t\t};\n\t}\n\n\t//data: { mobilePlayerInfo: { code: this.gamecode, askingForHost: true }\n\tconst myPlayer = useMemo(() => {\n\t\tif (!gameState || !gameState.players) {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\treturn gameState.players.find((p) => p.isLocal);\n\t\t}\n\t}, [gameState.players]);\n\n\tconst otherPlayers = useMemo(() => {\n\t\tlet otherPlayers: Player[];\n\t\tif (!gameState || !gameState.players || !myPlayer) return [];\n\t\telse otherPlayers = gameState.players.filter((p) => !p.isLocal);\n\t\tmaxDistanceRef.current = lobbySettings.visionHearing\n\t\t\t? myPlayer.isImpostor\n\t\t\t\t? lobbySettings.maxDistance\n\t\t\t\t: gameState.lightRadius + 0.5\n\t\t\t: lobbySettings.maxDistance;\n\t\tif (maxDistanceRef.current <= 0.6) {\n\t\t\tmaxDistanceRef.current = 1;\n\t\t}\n\t\thostRef.current = {\n\t\t\tmap: gameState.map,\n\t\t\tmobileRunning: hostRef.current.mobileRunning,\n\t\t\tgamestate: gameState.gameState,\n\t\t\tcode: gameState.lobbyCode,\n\t\t\thostId: gameState.hostId,\n\t\t\tisHost: gameState.hostId > 0 ? gameState.isHost : hostRef.current.serverHostId === gameState.clientId,\n\t\t\tparsedHostId: gameState.hostId > 0 ? gameState.hostId : hostRef.current.serverHostId,\n\t\t\tserverHostId: hostRef.current.serverHostId,\n\t\t};\n\t\tconst playerSocketIds: numberStringMap = {};\n\t\tfor (const k of Object.keys(socketClients)) {\n\t\t\tplayerSocketIds[socketClients[k].clientId] = k;\n\t\t}\n\t\tplayerSocketIdsRef.current = playerSocketIds;\n\t\tconst handledPeerIds: string[] = [];\n\t\tlet foundRadioUser = false;\n\t\tconst tempTalking = { ...otherTalking };\n\t\tlet talkingUpdate = false;\n\t\tfor (const player of otherPlayers) {\n\t\t\tconst peerId = playerSocketIds[player.clientId];\n\t\t\tconst audio = player.clientId === myPlayer.clientId ? undefined : audioElements.current[peerId];\n\t\t\tif (\n\t\t\t\tplayer.clientId === impostorRadioClientId.current &&\n\t\t\t\tplayer.isImpostor &&\n\t\t\t\t!player.isDead &&\n\t\t\t\t!player.disconnected &&\n\t\t\t\t!player.bugged\n\t\t\t) {\n\t\t\t\tfoundRadioUser = true;\n\t\t\t}\n\t\t\tif (audio) {\n\t\t\t\thandledPeerIds.push(peerId);\n\t\t\t\tlet gain = calculateVoiceAudio(gameState, settingsRef.current, myPlayer, player, audio);\n\t\t\t\tif (connectionStuff.current.deafened || playerConfigs[player.nameHash]?.isMuted) {\n\t\t\t\t\tgain = 0;\n\t\t\t\t}\n\n\t\t\t\tif (gain > 0) {\n\t\t\t\t\tconst playerVolume = playerConfigs[player.nameHash]?.volume;\n\t\t\t\t\tgain = playerVolume === undefined ? gain : gain * playerVolume;\n\n\t\t\t\t\tif (myPlayer.isDead && !player.isDead) {\n\t\t\t\t\t\tgain = gain * (settings.crewVolumeAsGhost / 100);\n\t\t\t\t\t}\n\t\t\t\t\tgain = gain * (settings.masterVolume / 100);\n\t\t\t\t}\n\t\t\t\taudio.gain.gain.value = gain;\n\t\t\t\ttempTalking[player.clientId] = otherVAD[player.clientId] && gain > 0;\n\t\t\t\tif (tempTalking[player.clientId] != otherTalking[player.clientId]) {\n\t\t\t\t\ttalkingUpdate = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (talkingUpdate) {\n\t\t\tsetOtherTalking(tempTalking);\n\t\t}\n\n\t\tif (\n\t\t\t((!foundRadioUser && impostorRadioClientId.current !== myPlayer.clientId) || !myPlayer.isImpostor) &&\n\t\t\timpostorRadioClientId.current !== -1\n\t\t) {\n\t\t\timpostorRadioClientId.current = -1;\n\t\t}\n\t\tfor (const peerId in Object.keys(audioElements.current).filter((e) => !handledPeerIds.includes(e))) {\n\t\t\tconst audio = audioElements.current[peerId];\n\t\t\tif (audio && audio.gain) {\n\t\t\t\taudio.gain.gain.value = 0;\n\t\t\t}\n\t\t\t// maybe disconnect later\n\t\t}\n\n\t\treturn otherPlayers;\n\t}, [gameState]);\n\n\t// Connect to P2P negotiator, when lobby and connect code change\n\tuseEffect(() => {\n\t\tif (connect?.connect) {\n\t\t\tconnect.connect(gameState?.lobbyCode ?? 'MENU', myPlayer?.id ?? 0, gameState.clientId, gameState.isHost);\n\t\t\tupdateLobby();\n\t\t}\n\t}, [connect?.connect, gameState?.lobbyCode, connected]);\n\n\tuseEffect(() => {\n\t\tif (myPlayer?.shiftedColor != -1) {\n\t\t\tconnectionStuff.current.socket?.emit('VAD', false);\n\t\t\tsetTalking(false)\n\t\t}\n\t}, [myPlayer?.shiftedColor])\n\n\tuseEffect(() => {\n\t\tif (myPlayer?.shiftedColor == -1 || !talking)\n\t\t\tconnectionStuff.current.socket?.emit('VAD', talking);\n\t}, [talking])\n\n\t// Connect to P2P negotiator, when game mode change\n\tuseEffect(() => {\n\t\tif (\n\t\t\tconnect?.connect &&\n\t\t\tgameState.lobbyCode &&\n\t\t\tmyPlayer?.clientId !== undefined &&\n\t\t\tgameState.gameState === GameState.LOBBY &&\n\t\t\t(gameState.oldGameState === GameState.DISCUSSION || gameState.oldGameState === GameState.TASKS)\n\t\t) {\n\t\t\thostRef.current.mobileRunning = false;\n\t\t\tconnect.connect(gameState.lobbyCode, myPlayer.clientId, gameState.clientId, gameState.isHost);\n\t\t} else if (\n\t\t\tgameState.oldGameState !== GameState.UNKNOWN &&\n\t\t\tgameState.oldGameState !== GameState.MENU &&\n\t\t\tgameState.gameState === GameState.MENU\n\t\t) {\n\t\t\tconsole.log('DISCONNECT TO MENU!');\n\t\t\t// On change from a game to menu, exit from the current game properly\n\t\t\thostRef.current.mobileRunning = false; // On change from a game to menu, exit from the current game properly\n\t\t\tconnectionStuff.current.socket?.emit('leave');\n\t\t\tObject.keys(peerConnections).forEach((k) => {\n\t\t\t\tdisconnectPeer(k);\n\t\t\t});\n\t\t\tsetOtherDead({});\n\t\t}\n\t}, [gameState.gameState]);\n\n\t// Emit player id to socket\n\tuseEffect(() => {\n\t\tif (connectionStuff.current.socket && myPlayer && myPlayer.clientId !== undefined) {\n\t\t\tconnectionStuff.current.socket.emit('id', myPlayer.id, gameState.clientId);\n\t\t}\n\t}, [myPlayer?.id, myPlayer?.clientId]);\n\n\t// Pass voice state to overlay\n\tuseEffect(() => {\n\t\tif (!settings.enableOverlay) {\n\t\t\treturn;\n\t\t}\n\t\tipcRenderer.send(IpcMessages.SEND_TO_OVERLAY, IpcOverlayMessages.NOTIFY_VOICE_STATE_CHANGED, {\n\t\t\totherTalking,\n\t\t\tplayerSocketIds: playerSocketIdsRef.current,\n\t\t\totherDead,\n\t\t\tsocketClients,\n\t\t\taudioConnected,\n\t\t\tlocalTalking: talking,\n\t\t\tlocalIsAlive: !myPlayer?.isDead,\n\t\t\timpostorRadioClientId: !myPlayer?.isImpostor ? -1 : impostorRadioClientId.current,\n\t\t\tmuted: mutedState,\n\t\t\tdeafened: deafenedState,\n\t\t\tmod: gameState.mod,\n\t\t} as VoiceState);\n\t}, [\n\t\totherTalking,\n\t\totherDead,\n\t\tsocketClients,\n\t\taudioConnected,\n\t\ttalking,\n\t\tmutedState,\n\t\tdeafenedState,\n\t\timpostorRadioClientId.current,\n\t]);\n\n\treturn (\n\t\t<div className={classes.root}>\n\t\t\t{(error || initialError) && (\n\t\t\t\t<div className={classes.error}>\n\t\t\t\t\t<Typography align=\"center\" variant=\"h6\" color=\"error\">\n\t\t\t\t\t\tERROR\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<Typography align=\"center\" style={{ whiteSpace: 'pre-wrap' }}>\n\t\t\t\t\t\t{error}\n\t\t\t\t\t\t{initialError}\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<SupportLink />\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t{(!error && !initialError) && (<>\n\n\t\t\t\t<div className={classes.top}>\n\t\t\t\t\t{myPlayer && gameState.lobbyCode !== 'MENU' && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<div className={classes.avatarWrapper}>\n\t\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t\tdeafened={deafenedState}\n\t\t\t\t\t\t\t\t\tmuted={mutedState}\n\t\t\t\t\t\t\t\t\tplayer={myPlayer}\n\t\t\t\t\t\t\t\t\tborderColor={myPlayer?.shiftedColor == -1 ? '#2ecc71' : 'gray'}\n\t\t\t\t\t\t\t\t\tconnectionState={connected ? 'connected' : 'disconnected'}\n\t\t\t\t\t\t\t\t\tisUsingRadio={myPlayer?.isImpostor && impostorRadioClientId.current === myPlayer.clientId}\n\t\t\t\t\t\t\t\t\ttalking={talking}\n\t\t\t\t\t\t\t\t\tisAlive={!myPlayer.isDead}\n\t\t\t\t\t\t\t\t\tsize={100}\n\t\t\t\t\t\t\t\t\tmod={gameState.mod}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t<div className={classes.right}>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div className={classes.left}>\n\t\t\t\t\t\t\t\t{myPlayer && gameState?.gameState !== GameState.MENU && (\n\t\t\t\t\t\t\t\t\t<span className={classes.username}>{myPlayer.name}</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={classes.code}\n\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\tbackground: gameState.lobbyCode === 'MENU' ? 'transparent' : '#3e4346',\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{displayedLobbyCode === 'MENU' ? t('game.menu') : displayedLobbyCode}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{gameState.lobbyCode !== 'MENU' && (\n\t\t\t\t\t\t\t\t<div className={classes.muteButtons}>\n\t\t\t\t\t\t\t\t\t<IconButton onClick={connectionStuff.current.toggleMute} size=\"small\">\n\t\t\t\t\t\t\t\t\t\t{mutedState || deafenedState ? <MicOff /> : <Mic />}\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t\t<IconButton onClick={connectionStuff.current.toggleDeafen} size=\"small\">\n\t\t\t\t\t\t\t\t\t\t{deafenedState ? <VolumeOff /> : <VolumeUp />}\n\t\t\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{lobbySettings.deadOnly && (\n\t\t\t\t\t<div className={classes.top}>\n\t\t\t\t\t\t<small style={{ padding: 0 }}>{t('settings.lobbysettings.ghost_only_warning2')}</small>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{lobbySettings.meetingGhostOnly && (\n\t\t\t\t\t<div className={classes.top}>\n\t\t\t\t\t\t<small style={{ padding: 0 }}>{t('settings.lobbysettings.meetings_only_warning2')}</small>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{gameState.lobbyCode && <Divider />}\n\t\t\t\t{displayedLobbyCode === 'MENU' && (\n\t\t\t\t\t<div className={classes.top}>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tstyle={{ margin: '10px' }}\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tipcRenderer.send(IpcHandlerMessages.OPEN_LOBBYBROWSER);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tcolor=\"primary\"\n\t\t\t\t\t\t\tvariant=\"outlined\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{t('buttons.public_lobby')}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{myPlayer && gameState.lobbyCode !== 'MENU' && (\n\t\t\t\t\t<Grid\n\t\t\t\t\t\tcontainer\n\t\t\t\t\t\tspacing={1}\n\t\t\t\t\t\tclassName={classes.otherplayers}\n\t\t\t\t\t\talignItems=\"flex-start\"\n\t\t\t\t\t\talignContent=\"flex-start\"\n\t\t\t\t\t\tjustifyContent=\"flex-start\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{otherPlayers.map((player) => {\n\t\t\t\t\t\t\tconst peer = playerSocketIdsRef.current[player.clientId];\n\t\t\t\t\t\t\tconst connected = socketClients[peer]?.clientId === player.clientId || false;\n\t\t\t\t\t\t\tconst audio = audioConnected[peer];\n\n\t\t\t\t\t\t\tif (!playerConfigs[player.nameHash]) {\n\t\t\t\t\t\t\t\tplayerConfigs[player.nameHash] = { volume: 1, isMuted: false };\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst socketConfig = playerConfigs[player.nameHash];\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Grid item key={player.id} xs={getPlayersPerRow(otherPlayers.length)}>\n\t\t\t\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\t\t\t\tconnectionState={!connected ? 'disconnected' : audio ? 'connected' : 'novoice'}\n\t\t\t\t\t\t\t\t\t\tplayer={player}\n\t\t\t\t\t\t\t\t\t\ttalking={!player.inVent && otherTalking[player.clientId]}\n\t\t\t\t\t\t\t\t\t\tborderColor=\"#2ecc71\"\n\t\t\t\t\t\t\t\t\t\tisAlive={!otherDead[player.clientId]}\n\t\t\t\t\t\t\t\t\t\tisUsingRadio={\n\t\t\t\t\t\t\t\t\t\t\tmyPlayer?.isImpostor &&\n\t\t\t\t\t\t\t\t\t\t\t!(player.disconnected || player.bugged) &&\n\t\t\t\t\t\t\t\t\t\t\timpostorRadioClientId.current === player.clientId\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tsize={50}\n\t\t\t\t\t\t\t\t\t\tsocketConfig={socketConfig}\n\t\t\t\t\t\t\t\t\t\tonConfigChange={() => setSetting(`playerConfigMap.${player.nameHash}`, playerConfigs[player.nameHash])}\n\t\t\t\t\t\t\t\t\t\tmod={gameState.mod}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Grid>\n\t\t\t\t)}\n\t\t\t</>)}\n\t\t\t{otherPlayers.length <= 6 && <Footer />}\n\t\t</div>\n\t);\n};\n\ntype ValidPlayersPerRow = 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12;\nfunction getPlayersPerRow(playerCount: number): ValidPlayersPerRow {\n\tif (playerCount <= 9) return (12 / 3) as ValidPlayersPerRow;\n\telse return Math.min(12, Math.floor(12 / Math.ceil(Math.sqrt(playerCount)))) as ValidPlayersPerRow;\n}\n\nexport default Voice;\n"]}